(this["webpackJsonppaku24-confirmator-front"]=this["webpackJsonppaku24-confirmator-front"]||[]).push([[0],{148:function(e){e.exports=JSON.parse('{"insideCapital":"insideCapital","outsideCapital":"outsideCapital","fromCapitalToOutside":"fromCapitalToOutside","fromOutsideToCapital":"fromOutsideToCapital"}')},179:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){},286:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(15),i=n.n(c),s=n(39),o=n(31),l=n(156),u=n.n(l),d=n(8),j=n.n(d),m=n(12),p=n(11),b=n(20),h=n(155),f=n(44),x=n(10),O=(n(179),n(341)),v=n(140),g=n(293),y=n(136),k=n(98),w=n.n(k),C=n(21),N=n(340),S=n(54),T=n(61),E=n(1);function D(e){var t=e.order,n=e.handleChange,a={marginTop:5},c={marginLeft:5,marginRight:5},i=Object(r.useState)(t.dateTime),s=Object(p.a)(i,2),o=s[0],l=s[1];return Object(r.useEffect)((function(){n({target:{name:"dateTime",value:o}})}),[o]),w.a.weekStart=1,Object(E.jsxs)("div",{className:"basic-flex",style:{marginTop:"5px"},children:[Object(E.jsxs)("div",{className:"flex-100-space-between flex-item",style:c,children:[Object(E.jsx)(C.a,{utils:y.a,locale:w.a,children:Object(E.jsx)(N.a,{ampm:!1,format:"DD-MM-YYYY HH:mm",minutesStep:15,style:c,className:"time-duration",name:"dateTime",value:t.dateTime,onChange:l,DialogProps:{disableScrollLock:!0}})}),Object(E.jsxs)(v.a,{className:"time-duration",style:Object(x.a)(Object(x.a)({},c),{},{paddingLeft:10}),name:"duration",value:null===t||void 0===t?void 0:t.duration,onChange:n,children:[Object(E.jsx)("option",{value:1,children:"1h"}),Object(E.jsx)("option",{value:1.5,children:"1.5h"}),Object(E.jsx)("option",{value:2,children:"2h"}),Object(E.jsx)("option",{value:2.5,children:"2.5h"}),Object(E.jsx)("option",{value:3,children:"3h"}),Object(E.jsx)("option",{value:3.5,children:"3.5h"}),Object(E.jsx)("option",{value:4,children:"4h"}),Object(E.jsx)("option",{value:4.5,children:"4.5h"}),Object(E.jsx)("option",{value:5,children:"5h"}),Object(E.jsx)("option",{value:5.5,children:"5.5h"}),Object(E.jsx)("option",{value:6,children:"6h"}),Object(E.jsx)("option",{value:6.5,children:"6.5h"}),Object(E.jsx)("option",{value:7,children:"7h"}),Object(E.jsx)("option",{value:7.5,children:"7.5h"}),Object(E.jsx)("option",{value:8,children:"8h"}),Object(E.jsx)("option",{value:8.5,children:"8.5h"}),Object(E.jsx)("option",{value:9,children:"9h"}),Object(E.jsx)("option",{value:9.5,children:"9.5h"}),Object(E.jsx)("option",{value:10,children:"10h"})]})]}),Object(E.jsx)(v.a,{fullWidth:!0,style:c,className:"flex-item",name:"serviceName",value:null===t||void 0===t?void 0:t.serviceName,onChange:n,children:S.map((function(e){return Object(E.jsx)("option",{value:e.name,children:e.name},e.id)}))}),Object(E.jsx)(v.a,{fullWidth:!0,style:c,className:"flex-item",name:"paymentType",value:null===t||void 0===t?void 0:t.paymentType,onChange:n,children:T.map((function(e){var t=e.name,n=e.id;return Object(E.jsx)("option",{value:t,children:t},n)}))}),Object(E.jsx)(O.a,{fullWidth:!0,style:a,className:"flex-item",required:!0,name:"address",value:null===t||void 0===t?void 0:t.address,onChange:n,label:"Address",variant:"outlined",size:"small"}),Object(E.jsx)(O.a,{fullWidth:!0,multiline:!0,style:a,className:"flex-item",name:"destination",value:null===t||void 0===t?void 0:t.destination,onChange:n,label:"Destination",variant:"outlined",size:"small"}),Object(E.jsx)(O.a,{fullWidth:!0,required:!0,style:a,className:"flex-item",name:"name",value:null===t||void 0===t?void 0:t.name,onChange:n,label:"Name",variant:"outlined",size:"small"}),Object(E.jsx)(O.a,{fullWidth:!0,style:a,className:"flex-item",name:"email",value:null===t||void 0===t?void 0:t.email,onChange:n,type:"email",label:"Email",variant:"outlined",size:"small"}),Object(E.jsx)(O.a,{fullWidth:!0,style:a,className:"flex-item",required:!0,name:"phone",value:null===t||void 0===t?void 0:t.phone,onChange:n,label:"Phonenumber",variant:"outlined",size:"small"}),Object(E.jsx)(g.a,{style:a,className:"flex-item textarea-2",rowsMin:3,cols:27,name:"comment",value:null===t||void 0===t?void 0:t.comment,placeholder:"Additional information.",onChange:n})]})}var z=n(335),I=n(334),L=n(338),F=n(344),P=n(343),U=n(348);function A(e){var t=e.handleChange,n=e.order;return Object(E.jsxs)("div",{className:"checkbox-container",children:[Object(E.jsxs)(I.a,{className:"checkbox-distance flex-item",hiddenLabel:!1,size:"small",children:[Object(E.jsx)(z.a,{component:"legend",children:"Pick one:"}),Object(E.jsxs)(U.a,{value:n.distance,onChange:t,children:[Object(E.jsx)(L.a,{name:"distance",value:"insideCapital",control:Object(E.jsx)(P.a,{color:"default"}),label:"\ud83c\udfd9 Inside capital"}),Object(E.jsx)(L.a,{name:"distance",value:"outsideCapital",control:Object(E.jsx)(P.a,{color:"default"}),label:"\ud83c\udfde Outside capital"}),Object(E.jsx)(L.a,{name:"distance",value:"fromCapitalToOutside",control:Object(E.jsx)(P.a,{color:"default"}),label:"\ud83c\udfd9->\ud83c\udfde From capital"}),Object(E.jsx)(L.a,{name:"distance",value:"fromOutsideToCapital",control:Object(E.jsx)(P.a,{color:"default"}),label:"\ud83c\udfde->\ud83c\udfd9 To capital"})]})]}),Object(E.jsxs)(I.a,{className:"basic-flex",size:"small",children:[Object(E.jsx)(L.a,{size:"small",className:"flex-item",control:Object(E.jsx)(F.a,{checked:n.hsy,onChange:t,color:"primary"}),name:"hsy",label:"\u267b HSY",labelPlacement:"start"}),Object(E.jsx)(L.a,{className:"flex-item",control:Object(E.jsx)(F.a,{checked:n.altColorPalette,onChange:t,color:"primary"}),name:"altColorPalette",label:"Second car",labelPlacement:"start"}),Object(E.jsx)(L.a,{className:"flex-item",control:Object(E.jsx)(F.a,{checked:n.XL,onChange:t,color:"primary"}),name:"XL",label:"XL",labelPlacement:"start"})]})]})}var R=n(73),M=n.n(R),W=n(141),q=n.n(W);function B(e){var t=e.validationArray,n={color:"red"};return Object(E.jsx)(E.Fragment,{children:t.map((function(e){return e.isError?Object(E.jsxs)("div",{children:[Object(E.jsxs)("span",{style:n,children:[e.name," "]}),e.message]},e.id):null}))})}function J(e){var t=e.order,n=e.shouldValidate,a=Object(r.useState)([]),c=Object(p.a)(a,2),i=c[0],s=c[1];Object(r.useEffect)((function(){if(n){var e=[{id:1,name:"Date and time",isError:M.a.isBefore(t.dateTime.toISOString(),(new Date).toISOString()),message:"might have some problems. Check to be sure: ".concat("".concat(t.confirmationDateString," ").concat(t.time)||"---")},{id:2,name:"Address",isError:M.a.isEmpty(t.address),message:"is missing"},{id:3,name:"Phonenumber",isError:!M.a.isMobilePhone(t.phone,["fi-FI","es-ES","sv-SE"]),message:"is missing or is incorrect: ".concat(t.phone||"---")},{id:4,name:"Email",isError:!M.a.isEmail(t.email),message:"is missing or is incorrect: ".concat(t.email||"---")}];s(e)}}),[t.dateTime,t.phone,t.address,t.email,n]);var o=i.some((function(e){return e.isError}));return Object(E.jsx)(E.Fragment,{children:n&&o&&Object(E.jsx)("div",{style:{borderTop:"1px solid gray",borderBottom:"1px solid gray",padding:"15px 0 15px 0",margin:"10px 0 10px 0"},className:"flex-100-space-between",children:Object(E.jsxs)("div",{children:[Object(E.jsx)(q.a,{}),Object(E.jsx)(B,{validationArray:i})]})})})}var H=n(64),K=n(333),X=n(294),Y=n(142),V=n.n(Y),_=(n(261),function(e,t){return function(n){var a=n.content,c=n.handleUpdate,i=Object(H.a)(n,["content","handleUpdate"]),s=Object(r.useState)(!1),o=Object(p.a)(s,2),l=o[0],u=o[1],d=Object(r.useState)(a),j=Object(p.a)(d,2),m=j[0],b=j[1],h=Object(r.useState)(m),f=Object(p.a)(h,2),O=f[0],v=f[1];function g(e){v(e.target.value)}function y(){v(m),u(!l)}function k(){b(O),c(O),u(!l)}function w(){u(!l)}return Object(E.jsx)(E.Fragment,{children:l?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(e,Object(x.a)({content:O,handleChange:g},i)),Object(E.jsxs)("div",{className:"buttons-block",children:[Object(E.jsx)(K.a,{size:"small",onClick:y,children:"Cancel"}),Object(E.jsx)(K.a,{className:"primary",size:"small",onClick:k,children:"Save"})]})]}):Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(t,Object(x.a)({content:a,button:Object(E.jsx)("span",{children:Object(E.jsx)(X.a,{size:"small",onClick:w,children:Object(E.jsx)(V.a,{style:{width:"20px"}})})})},i))})})}});function $(e){var t=e.handleClick,n=e.rawOrderText,r=e.elementRef,a=_((function(e){var t=e.handleChange,n=e.content;return Object(E.jsx)(g.a,{onChange:t,value:n,style:{marginTop:"10px"},className:"width-100",rowsMin:5,cols:40,placeholder:"Raw order here."})}),(function(e){var t=e.button;return Object(E.jsxs)("div",{ref:r,className:"not-editable-container",children:["Raw order",t]})}));return Object(E.jsx)(a,{style:{width:"max-content"},handleUpdate:t,content:n})}n(262);function G(e){var t=e.elementRef,n=e.handleClick,r=e.transformedOrderText,a=_((function(e){var n=e.handleChange,r=e.content;return Object(E.jsx)(g.a,{onChange:n,value:r,ref:t,style:{marginTop:"10px"},className:"width-100",rowsMin:5,cols:40,placeholder:"Transformed order."})}),(function(e){var n=e.content,a=e.button;return Object(E.jsxs)("div",{ref:t,style:{width:r&&"100%",marginTop:"12px"},className:"not-editable-container",children:[0===n.length?"Transformed order":Object(E.jsx)("div",{className:"text-container-with-scroll",children:n.split("\n").map((function(e,t){return Object(E.jsx)("div",{children:e},t)}))}),a]})}));return Object(E.jsx)(a,{handleUpdate:n,content:r})}var Q=n(143),Z=n.n(Q);function ee(e){var t=e.handleClick,n=e.text,r=void 0===n?"Transform":n,a=Object(H.a)(e,["handleClick","text"]);return Object(E.jsxs)(K.a,Object(x.a)(Object(x.a)({className:"button-one-third flex-item",variant:"outlined",size:"small",style:{fontSize:"0.8rem",padding:"1px"},onClick:function(){return t()}},a),{},{children:[Object(E.jsx)(Z.a,{}),r]}))}var te=n(144),ne=n.n(te);function re(e){var t=e.elementRef,n=e.disabled,r=Object(o.b)().enqueueSnackbar;return Object(E.jsxs)(K.a,{disabled:n,className:"button-one-third flex-item",variant:"outlined",size:"small",onClick:function(){!function(){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t.current.innerText||t.current.defaultValue,e.select(),document.execCommand("copy"),document.body.removeChild(e)}(),r("Copied!",{autoHideDuration:750})},children:["Copy ",Object(E.jsx)(ne.a,{})]})}function ae(e){var t=e.handleOrderTransformFromText,n=e.handleOrderTransformFromEditor,r=e.transformDisabled,a=e.copyDisabled,c=e.elementRef;return Object(E.jsx)("div",{className:"order-operations",children:Object(E.jsxs)("div",{className:"block",children:[Object(E.jsx)(re,{disabled:a,elementRef:c}),Object(E.jsx)(ee,{text:"from text",disabled:r,handleClick:t}),Object(E.jsx)(ee,{text:"from editor",handleClick:n})]})})}var ce=n(145),ie=n.n(ce);function se(e){var t=e.handleClick,n=e.className;return Object(E.jsxs)(K.a,{className:n,variant:"contained",size:"small",onClick:t,children:["New order ",Object(E.jsx)(ie.a,{})]})}function oe(e){var t=e.className,n=e.orderPoolUrl,r=Object(b.g)();return Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(K.a,{size:"small",className:t,variant:"contained",onClick:function(){r.push(n)},children:"Order Pool"})})}function le(e){var t=e.text,n=e.className,r=Object(H.a)(e,["text","className"]);return Object(E.jsx)("div",Object(x.a)(Object(x.a)({className:"message ".concat(n)},r),{},{children:t}))}var ue=n(146),de=n.n(ue);function je(e){var t=e.handleClick,n=e.isDisabled,r=e.grayScale,a=e.content,c=e.className,i=r&&{color:"grey"};return Object(E.jsx)(K.a,{disabled:n,className:c,variant:"contained",size:"small",onClick:t,children:Object(E.jsx)("span",{style:Object(x.a)({display:"flex"},i),children:a})})}var me=n(46),pe=n.n(me),be="/api/token";function he(){return(he=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.axiosInstance.post(be);case 2:return e.next=4,Oe.axiosInstance.post("".concat(be,"/is-new"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fe={refreshTokens:function(){return he.apply(this,arguments)}},xe=pe.a.create();var Oe={axiosInstance:xe,setupInterceptor:function(e){xe.interceptors.response.use((function(e){return e}),function(){var t=Object(m.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.config,"access token expired"!==n.response.data.error){t.next=5;break}return t.next=4,fe.refreshTokens();case 4:return t.abrupt("return",xe(r));case 5:if("access token missing"!==n.response.data.error&&"invalid access token"!==n.response.data.error&&"refresh token expired"!==n.response.data.error&&"invalid refresh token"!==n.response.data.error&&"refresh token missing"!==n.response.data.error){t.next=9;break}throw e.notificate(),e.logout(),new Error("logout");case 9:return 429===n.response.status&&setTimeout((function(){return null}),1500),t.abrupt("return",Promise.reject(n));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},ve="/api/email";function ge(){return(ge=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.axiosInstance.post("".concat(ve,"/send-confirmation"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ye="email";function ke(e){var t=e.email,n=e.order,r=e.transformedOrderText,a=e.statusText,c=e.isDisabled,i=e.changeStatus,s=e.className,l=Object(o.b)().enqueueSnackbar;var u=a||Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("span",{children:"Send"})," ",Object(E.jsx)(de.a,{})]});return Object(E.jsx)(je,{className:s,isDisabled:c,grayScale:null!==a,handleClick:function(){return t&&r?(i(ye,"Working",!0),function(e){return ge.apply(this,arguments)}({orderDetails:r,order:n,email:t}).then((function(e){i(ye,"Done",!0),l(e.message)})).catch((function(e){"logout"!==e.message&&(i(ye,"Error",!1),l(e.response.data.error,{variant:"error"}))}))):l("No confirmation found or recipients defined.",{variant:"warning"})},content:u})}var we=n(147),Ce=n.n(we),Ne="/api/sms";function Se(e){return Te.apply(this,arguments)}function Te(){return(Te=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.axiosInstance.post(Ne,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee="sms";function De(e){var t=e.phone,n=e.transformedOrderText,r=e.statusText,a=e.isDisabled,c=e.changeStatus,i=e.className,s=Object(o.b)().enqueueSnackbar;function l(){return(l=Object(m.a)(j.a.mark((function e(){var r,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=n)||!t){e.next=9;break}return c(Ee,"Working",!0),e.next=6,Se({msg:r,phone:t});case 6:a=e.sent,c(Ee,"Done",!0),s("".concat(a.message));case 9:e.next=17;break;case 11:if(e.prev=11,e.t0=e.catch(0),"logout"!==e.t0.message){e.next=15;break}return e.abrupt("return");case 15:c(Ee,"Error",!1),s(null===(i=e.t0.response)||void 0===i?void 0:i.data.error,{variant:"error"});case 17:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var u=r||Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("span",{children:"Send"})," ",Object(E.jsx)(Ce.a,{})]});return Object(E.jsx)(je,{className:i,isDisabled:a,grayScale:null!==r,handleClick:function(){return l.apply(this,arguments)},content:u})}var ze=n(149),Ie=n.n(ze),Le="/api/calendar";function Fe(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.axiosInstance.post(Le,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue="/api/order-pool";function Ae(e,t){return t.map((function(n,r){var a=r===t.length-1;return"".concat(e,"[]=").concat(n).concat(a?"":"&")})).join("")}function Re(e){var t=e.query,n=e.orders;return new Promise((function(e){return e(sessionStorage.setItem("order-pool/".concat(t),JSON.stringify({validUntil:Date.now()+3e5,orders:n})))}))}function Me(e){return Promise.resolve().then((function(){return JSON.parse(sessionStorage.getItem("order-pool/".concat(e)))}))}function We(e){return Promise.resolve(function(){try{return JSON.parse(sessionStorage.getItem("order-pool/".concat(e))).validUntil>Date.now()}catch(t){return!1}}())}function qe(){return(qe=Object(m.a)(j.a.mark((function e(){var t,n,r,a,c,i,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:[1],n=s.length>1&&void 0!==s[1]?s[1]:{deleted:!1,forceUpdate:!1},r=n.deleted,a=n.forceUpdate,c="".concat(r?"deleted=true":"deleted=false","&").concat(Ae("pages",t)),e.t0=!a,!e.t0){e.next=9;break}return e.next=8,We(c);case 8:e.t0=e.sent;case 9:if(!e.t0){e.next=11;break}return e.abrupt("return",Me(c).then((function(e){return e.orders})));case 11:return i="".concat(Ue,"/?").concat(c),e.abrupt("return",Oe.axiosInstance.get(i).then(function(){var e=Object(m.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null===t||void 0===t?void 0:t.data,r=n.orders,e.next=3,Re({query:c,orders:r});case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(){return(Be=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe.axiosInstance.put("".concat(Ue,"/confirm/").concat(t)).then((function(e){return null===e||void 0===e?void 0:e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(){return(Je=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.axiosInstance.delete("".concat(Ue,"/delete/").concat(t));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(){return(He=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.axiosInstance.put("".concat(Ue,"/retrieve/").concat(t));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ke={get:function(){return qe.apply(this,arguments)},confirm:function(e){return Be.apply(this,arguments)},remove:function(e){return Je.apply(this,arguments)},retrieve:function(e){return He.apply(this,arguments)}},Xe=n(101),Ye=n(86),Ve=n(87),_e=n(89),$e=n(67);function Ge(e){return"Cannot find ".concat(e)}var Qe=function(){function e(t){Object(Ye.a)(this,e),this.textOrder=e.initialCleanup(t)}return Object(Ve.a)(e,[{key:"dateTime",get:function(){var e=/(?<=Date and time: \w+, )\w+ \d+(th|rd|st|nd)? \w+/.exec(this.textOrder);if(!e)throw new Error(Ge("date"));var t=new Date("".concat(e[0].replace(/th|rd|st|nd/,""),"Z")),n=/\d+:\d+/.exec(this.textOrder)[0];return new Date("\n    ".concat(t.getFullYear(),"\n    ").concat(t.getMonth()+1,"\n    ").concat(t.getDate(),"\n    ").concat(n))}},{key:"duration",get:function(){var e=/\d+(\.\d+)?(?=\sh.)/.exec(this.textOrder);if(!e)throw new Error(Ge("duration"));return e[0]}},{key:"paymentType",get:function(){var e="Payment Type: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("PRICE"),r=this.textOrder.slice(t,n).trim(),a=r.match(/\W+/g).filter((function(e){return"/"!==e&&" "!==e&&"\xe4"!==e})),c=r.indexOf(a[0].trim()),i=r.slice(0,c).trim();if(!i)throw new Error(Ge("payment type"));if(!T.map((function(e){return e.name})).includes(i))throw new Error("Unrecognized payment type");return i}},{key:"movingBoxesPrice",get:function(){var e=this.textOrder.indexOf("\u2014 Price: "),t=this.textOrder.indexOf("\u2014 Booking time start"),n=this.textOrder.slice(e,t);return n&&n.match(/\d+/)[0]}},{key:"serviceName",get:function(){var e="Service: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("Accessories"),r=this.textOrder.slice(t,n).trim();if(!r)throw new Error(Ge("service name"));if(!S.find((function(e){return e.name===r})))throw new Error("Unrecognized service name");return r}},{key:"addresses",get:function(){var e=this,t=["End location","Name"],n=[];return["Start location:","End location:"].forEach((function(r,a){var c=e.textOrder.indexOf(r)+r.length,i=e.textOrder.indexOf(t[a]),s=e.textOrder.slice(c,i).replaceAll(",","").trim(),o=s.slice(0,s.indexOf(" / ")),l=s.match(/\d{5}/);l=l&&l[0]||"";var u=s.slice(s.indexOf(" / ")+" / ".length),d=o.match(/\D+/);d=d&&d[0];var j=u.replace(l,"");if(j=j||null,(!/\d+/.test(u)||u.includes(l)&&u.length<15)&&(j=o.replace(l,""),d=(d=u.match(/\D+/))&&d[0]),j.includes(d)&&(j=j.replace(d,"")),0===a&&!j)throw new Error(Ge("address"));n.push("".concat(j,", ").concat(l," ").concat(d).replace(/\s+/g," ").trim())})),n}},{key:"address",get:function(){return this.addresses[0]}},{key:"destination",get:function(){return Object(p.a)(this.addresses,2)[1]}},{key:"name",get:function(){var e="Name: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("Email"),r=this.textOrder.slice(t,n).trim();if(!r)throw new Error(Ge("name"));return r}},{key:"email",get:function(){var e=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.exec(this.textOrder);if(!e)throw new Error(Ge("email"));return e[0]}},{key:"phone",get:function(){var e=/(?<=Phone: )[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*/.exec(this.textOrder);if(!e)throw new Error(Ge("phone"));return e[0].trim()}},{key:"comment",get:function(){var e=/(?<=Comment: )(.*\s*)*/.exec(this.textOrder);e=e?e[0]:"";var t=/\n\n\-\-\nT\xe4m\xe4 viesti l\xe4hetettiin sivustolta Paku24\.fi \(https:\/\/paku24\.fi\)/;return t.exec(e)&&(e=e.replace(t,"")),e}}],[{key:"initialCleanup",value:function(e){var t=e.split("\n"),n=[];return t.forEach((function(e){return n.push(e.trim())})),n.join("\n").replaceAll("\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014","").replaceAll("------------------------","")}}]),e}(),Ze=n(148),et={dateTime:new Date,duration:1,serviceName:S[0].name,paymentType:T[0].name,address:"",destination:"",name:"",email:"",phone:"",comment:"",distance:Ze.insideCapital,hsy:!1,altColorPalette:!1,XL:!1},tt=Object.keys(et),nt=function(){function e(t){Object(Ye.a)(this,e);var n,r=Object(Xe.a)(tt);try{for(r.s();!(n=r.n()).done;){var a,c=n.value;this[c]=null!==(a=t[c])&&void 0!==a?a:et[c]}}catch(i){r.e(i)}finally{r.f()}this.dateTime=new Date(t.dateTime)}return Object(Ve.a)(e,[{key:"time",get:function(){return this.dateTime.toTimeString().slice(0,5)}},{key:"servicePrice",get:function(){var e=this,t=S.find((function(t){return t.name===e.serviceName}));return this.XL?t.priceXL:t.price}},{key:"ISODateString",get:function(){return"".concat(this.dateTime.toISOString().split("T")[0],"T").concat(this.time)}},{key:"confirmationDateString",get:function(){var e=this.dateTime.getDate(),t=this.dateTime.getMonth()+1,n=this.dateTime.getFullYear();return e<10&&(e="0".concat(e)),t<10&&(t="0".concat(t)),"".concat(e,"-").concat(t,"-").concat(n)}},{key:"fees",get:function(){var e=1*this.time.split(":")[0],t=this.dateTime.getDay(),n=this.dateTime.getDate(),r=[new Date(this.dateTime.getFullYear(),this.dateTime.getMonth()+1,0).getDate(),1],a=6===t||0===t,c=!a&&r.includes(n),i=e<8,s=e>20,o="Lasku"===this.paymentType||"Lasku/Osamaksu"===this.paymentType||"Invoice/Instalment payment"===this.paymentType;return[a&&$e.weekend,c&&$e.firstOrLastDayOfTheMonth,i&&$e.morning,s&&$e.night,o&&$e.bill].filter((function(e){return!1!==e}))}},{key:"printFees",value:function(){var e="\n@feeName\n@feeAmount".repeat(this.fees.length);return this.fees.forEach((function(t){e=(e=e.replace("@feeName",t.name.toUpperCase())).replace("@feeAmount","".concat(t.amount,"\u20ac"))})),e}}],[{key:"getEventForCalendar",value:function(e,t){return e.slice(e.indexOf(t))}},{key:"setupOrderFromText",value:function(t){return new Promise((function(n){Object(_e.a)(t)&&n(new e(JSON.parse(t)));var r,a={},c=new Qe(t),i=Object(Xe.a)(tt);try{for(i.s();!(r=i.n()).done;){var s=r.value;a[s]=c[s]}}catch(o){i.e(o)}finally{i.f()}n(new e(a))}))}},{key:"default",value:function(){return new e(et)}},{key:"transformToText",value:function(e,t){var n;try{n="VARAUKSEN TIEDOT\n".concat(e.confirmationDateString,"\nALKAMISAIKA\nKlo ").concat(e.time," (+/-15min)\nARVIOITU KESTO\n").concat(e.duration,"h (").concat(e.servicePrice,"\u20ac/h, ").concat(e.serviceName,")\nMAKSUTAPA\n").concat(e.paymentType).concat(e.printFees(),"\nL\xc4HT\xd6PAIKKA\n").concat(e.address,"\n").concat(e.destination.length>5?"M\xc4\xc4R\xc4NP\xc4\xc4\n".concat(e.destination,"\n"):"","NIMI\n").concat(e.name,"\n").concat(e.email?"S\xc4HK\xd6POSTI\n".concat(e.email,"\n"):"","PUHELIN\n").concat(e.phone,"\n").concat(e.comment?"LIS\xc4TIETOJA\n".concat(e.comment,"\n"):""),t("Succesefully formatted!")}catch(r){console.error(r),t(r.message)}return n}}]),e}(),rt="calendar";function at(e){var t=e.order,n=e.orderId,r=e.transformedOrderText,a=e.statusText,c=e.isDisabled,i=e.changeStatus,s=e.className,l=Object(o.b)().enqueueSnackbar;function u(){return(u=Object(m.a)(j.a.mark((function e(){var a,c,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(a=nt.getEventForCalendar(r,t.address))){e.next=12;break}return i(rt,"Working",!0),e.next=6,Fe({entry:a,order:t,fees:t.fees});case 6:if(c=e.sent,!n){e.next=10;break}return e.next=10,Ke.confirm(n);case 10:i(rt,"Done",!0),l("".concat(c.message,"\n").concat(c.createdEvent));case 12:e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(0),"logout"!==e.t0.message){e.next=18;break}return e.abrupt("return");case 18:i(rt,"Error",!1),l(null===(s=e.t0.response)||void 0===s?void 0:s.data.error,{variant:"error"});case 20:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}var d=a||Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("span",{children:"Add"})," ",Object(E.jsx)(Ie.a,{})]});return Object(E.jsx)(je,{className:s,isDisabled:c,grayScale:null!==a,handleClick:function(){return u.apply(this,arguments)},content:d})}n(283);function ct(e){var t=e.order,n=e.orderId,a=e.transformedOrder,c=e.handleResetClick,i=e.orderPoolUrl,s={email:{status:null,disable:!1},sms:{status:null,disable:!1},calendar:{status:null,disable:!1}},o=Object(r.useState)(s),l=Object(p.a)(o,2),u=l[0],d=l[1];function j(e,t,n){d(Object(x.a)(Object(x.a)({},u),{},Object(f.a)({},e,{status:t,disable:n})))}return Object(E.jsxs)("div",{className:"order-operations",children:[function(){var e=u.email.disable||!(t.email&&a.text);return Object(E.jsxs)("div",{className:"block",children:[Object(E.jsx)(le,{className:"width-75 ".concat(e&&"grayedFont"),text:"Email to: ".concat(t.email)}),Object(E.jsx)(ke,{className:"width-25",email:t.email,order:t,statusText:u.email.status,isDisabled:e,transformedOrderText:a.text,changeStatus:j})]})}(),function(){var e=u.sms.disable||!(t.phone&&a.text);return Object(E.jsxs)("div",{className:"block",children:[Object(E.jsx)(le,{className:"width-75 ".concat(e&&"grayedFont"),text:"Sms to: ".concat(t.phone)}),Object(E.jsx)(De,{className:"width-25",statusText:u.sms.status,isDisabled:e,phone:t.phone,transformedOrderText:a.text,changeStatus:j})]})}(),function(){var e=u.calendar.disable||!a.text;return Object(E.jsxs)("div",{className:"block",children:[Object(E.jsx)(se,{className:"share-space",handleClick:function(){d(s),c()}}),Object(E.jsx)(oe,{className:"share-space",orderPoolUrl:i}),Object(E.jsx)(at,{className:"width-25",statusText:u.calendar.status,isDisabled:e,order:t,orderId:n,transformedOrderText:a.text,changeStatus:j})]})}()]})}var it=n(345),st=n(337),ot=n(336),lt=n(339),ut=n(30);function dt(e){var t=e.children,n=e.handleClose,r=Object(ut.a)(),a=Object(lt.a)(r.breakpoints.down("sm"));return Object(E.jsx)(E.Fragment,{children:Object(E.jsxs)(it.a,{fullScreen:a,open:!0,onClose:n,"aria-labelledby":"responsive-dialog-title",disableScrollLock:!0,children:[Object(E.jsx)(ot.a,{children:t}),Object(E.jsx)(st.a,{children:Object(E.jsx)(K.a,{style:{backgroundColor:"white"},variant:"text",onClick:n,children:"Close"})})]})})}var jt=n(88),mt=n(150),pt=n.n(mt),bt=n(152),ht=n.n(bt),ft=n(151),xt=n.n(ft);function Ot(e){var t=e.loading,n=e.redirectComponent,r=void 0===n?null:n,a=e.children;return Object(E.jsxs)(E.Fragment,{children:[t&&Object(E.jsx)("p",{children:"Loading..."}),r,!t&&!r&&a]})}function vt(e){var t=e.orders,n=e.handleExport,a=e.handleDeletion,c=e.handleLoadingMoreOrders,i=e.labelForDeletion,s=Object(r.useState)([]),o=Object(p.a)(s,2),l=o[0],u=o[1];function d(e,t){return e.split("\n").map((function(e,n){return Object(E.jsx)("div",{children:e},"".concat(t).concat(n).concat(e))}))}return Object(r.useEffect)((function(){u(t.map((function(e){return{order:Object(x.a)({},e),isNew:new Date(e.date).toDateString()===new Date(Date.now()).toDateString(),className:e.confirmed?"basic-order-style confirmed-order-style":"basic-order-style",hidden:e.confirmed}})))}),[t]),0===t.length?Object(E.jsx)("p",{children:"Nothing found"}):Object(E.jsxs)(E.Fragment,{children:[l.map((function(e){return Object(E.jsxs)("div",{className:"order-pool-list",children:[Object(E.jsxs)("div",{className:"order-top-bar",children:[Object(E.jsxs)("div",{className:"order-status-icons-container",children:[e.isNew&&Object(E.jsx)("span",{className:"order-status-new-order order-status-icon",children:"NEW"}),Object(E.jsxs)("span",{className:"order-status-icon ".concat(e.order.confirmed?"order-status-icon order-status-confirmed":"order-status-icon order-status-notification"),children:[e.order.confirmed?"\u2714":"\u2755"," "]})]}),Object(E.jsxs)("div",{className:"order-actions",children:[Object(E.jsx)(K.a,{style:{padding:0,fontSize:"0.9rem"},variant:"text",size:"small",onClick:function(){return a(e.order.id)},children:i}),Object(E.jsx)(K.a,{style:{padding:0,fontSize:"0.8rem",color:e.order.confirmed&&"var(--brand-color-dark)"},onClick:function(){n(e.order)},variant:"text",size:"small",children:"Export"}),Object(E.jsx)(K.a,{style:{padding:0},variant:"text",size:"small",onClick:function(){return function(e){u(Object(jt.a)(l.map((function(t){return t.order.id===e.order.id?Object(x.a)(Object(x.a)({},e),{},{hidden:!t.hidden,className:t.hidden?"basic-order-style":"basic-order-style confirmed-order-style"}):t}))))}(e)},children:e.hidden?"Show \u2795":"Hide \u2796"})]})]}),Object(E.jsx)("div",{className:e.className,children:Object(_e.a)(e.order.text)?(t=e.order.text,r=e.order.id,Object.entries(JSON.parse(t)).map((function(e,t){var n=Object(p.a)(e,2),a=n[0],c=n[1];return Object(E.jsxs)("div",{style:{minHeight:"1.2rem",backgroundColor:t%2!==0&&"var(--brand-color-very-light)"},children:[Object(E.jsx)("span",{style:{fontWeight:"bold"},children:a}),":"," ","dateTime"===a?"".concat(new Date(c).toLocaleDateString()," ").concat(new Date(c).toLocaleTimeString().slice(0,5)):c]},"".concat(a).concat(c).concat(r))}))):d(e.order.text,e.order.id)})]},e.order.id);var t,r})),Object(E.jsx)(K.a,{onClick:c,size:"small",children:"Load more"})]})}n(284);var gt="inbox",yt="trashcan";function kt(e){var t=e.handleExport,n=Object(r.useState)([]),a=Object(p.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(!0),o=Object(p.a)(s,2),l=o[0],u=o[1],d=Object(r.useState)(gt),b=Object(p.a)(d,2),h=b[0],v=b[1],g=Object(r.useState)({inbox:{pages:[1],searchText:"",showOnlyNotConfirmed:!1},trashcan:{pages:[1],searchText:"",showOnlyNotConfirmed:!1}}),y=Object(p.a)(g,2),k=y[0],w=y[1],C=Object(r.useState)(c),N=Object(p.a)(C,2),S=N[0],T=N[1],D=Object(r.useState)({hasToUpdate:!1,trigger:0}),z=Object(p.a)(D,2),I=z[0],L=z[1],F=Object(r.useState)({inbox:[1],trashcan:[1]}),P=Object(p.a)(F,2),U=P[0],A=P[1],R=c.length,M=c.filter((function(e){return!e.confirmed})).length;function W(e,t,n){var r;return function(e,t){return t?e.filter((function(e){return!1===(null===e||void 0===e?void 0:e.confirmed)})):e}((r=e,n.filter((function(e){return e.text.toLowerCase().includes(null===r||void 0===r?void 0:r.toLowerCase().trim())}))),t)}function q(){return(q=Object(m.a)(j.a.mark((function e(){var t,n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[U[h].length+1],A(Object(x.a)(Object(x.a)({},U),{},Object(f.a)({},h,[].concat(Object(jt.a)(U[h]),t)))),h!==gt){e.next=8;break}return e.next=5,Ke.get(t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Ke.get(t,{deleted:!0});case 10:e.t0=e.sent;case 11:n=e.t0,r=c.concat(n),i(r),a=W(k[h].searchText,k[h].showOnlyNotConfirmed,r),T(a);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){v(e.target.dataset.tabname)}function J(){return(J=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.remove(t);case 2:i(c.filter((function(e){return e.id!==t}))),T(S.filter((function(e){return e.id!==t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.retrieve(t);case 2:i(c.filter((function(e){return e.id!==t}))),T(S.filter((function(e){return e.id!==t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)(Object(m.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),e.prev=1,h!==gt){e.next=8;break}return e.next=5,Ke.get(U[h],{forceUpdate:I.hasToUpdate});case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Ke.get(U[h],{deleted:!0,forceUpdate:I.hasToUpdate});case 10:e.t0=e.sent;case 11:return t=e.t0,i(t),n=W(k[h].searchText,k[h].showOnlyNotConfirmed,t),T(n),e.abrupt("return",u(!1));case 18:return e.prev=18,e.t1=e.catch(1),e.abrupt("return",e.t1);case 21:case"end":return e.stop()}}),e,null,[[1,18]])}))),[h,I.trigger]);return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("div",{className:"tab-panel",children:[Object(E.jsx)(K.a,{onClick:B,className:"p-0",variant:"text",size:"small",children:Object(E.jsx)("h3",{"data-tabname":gt,className:h===gt?"tab-panel-item tab-panel-item-selected":"tab-panel-item",children:"Inbox"})}),Object(E.jsx)(K.a,{onClick:B,className:"p-0",variant:"text",size:"small",children:Object(E.jsx)("h3",{"data-tabname":yt,className:h===yt?"tab-panel-item tab-panel-item-selected":"tab-panel-item",children:"Trashcan"})}),Object(E.jsx)(X.a,{style:{marginLeft:"auto",marginRight:"12px"},onClick:function(){L(Object(x.a)(Object(x.a)({},I),{},{trigger:I.trigger+1,hasToUpdate:!0})),setTimeout((function(){return L(Object(x.a)(Object(x.a)({},I),{},{hasToUpdate:!1}))}))},className:"p-0",variant:"text",size:"small",children:Object(E.jsx)(pt.a,{})})]}),Object(E.jsxs)("div",{className:"filters-tab",children:[Object(E.jsxs)("span",{className:"filters-tab-orders-count",children:[S.length,"/",c.length]}),Object(E.jsx)(O.a,{className:"flex-item",type:"text",name:"searchText",placeholder:"Search",value:k[h].searchText,onChange:function(e){var t=k[h];w(Object(x.a)(Object(x.a)({},k),{},Object(f.a)({},h,Object(x.a)(Object(x.a)({},t),{},{searchText:e.target.value}))));var n=W(e.target.value,t.showOnlyNotConfirmed,c);T(n)}}),M>0&&Object(E.jsxs)(K.a,{className:"p-0 filters-tab-orders-status-icon",size:"small",onClick:function(){return function(e){var t=k[h];w(Object(x.a)(Object(x.a)({},k),{},Object(f.a)({},h,Object(x.a)(Object(x.a)({},t),{},{showOnlyNotConfirmed:e}))));var n=W(t.searchText,e,c);T(n)}(!k[h].showOnlyNotConfirmed)},children:[Object(E.jsx)("span",{style:{fontSize:"1rem"},children:k[h].showOnlyNotConfirmed?R:M}),Object(E.jsx)("span",{className:"order-status-icon order-status-notification ".concat(k[h].showOnlyNotConfirmed&&"order-status-icon-selected"),children:k[h].showOnlyNotConfirmed?"\u2714&\u2755":"\u2755"})]})]}),Object(E.jsx)(Ot,{loading:l,children:Object(E.jsx)(vt,{orders:S,handleExport:t,labelForDeletion:h===yt?Object(E.jsx)(xt.a,{}):Object(E.jsx)(ht.a,{}),handleDeletion:h===yt?function(e){return H.apply(this,arguments)}:function(e){return J.apply(this,arguments)},handleLoadingMoreOrders:function(){return q.apply(this,arguments)}})})]})}function wt(e){var t=e.handleExport,n=Object(b.g)(),r=function(){n.goBack()};return Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(dt,{handleClose:r,children:Object(E.jsx)(kt,{handleExport:function(e){t(e),r()}})})})}function Ct(){var e=Object(r.useState)({text:"",id:null}),t=Object(p.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)({text:"",id:null}),i=Object(p.a)(c,2),s=i[0],l=i[1],u=Object(r.useState)(nt.default()),d=Object(p.a)(u,2),j=d[0],m=d[1];Object(r.useEffect)((function(){var e=localStorage.getItem("confirmator_order");e&&m(new nt(JSON.parse(e)))}),[]),Object(r.useEffect)((function(){localStorage.setItem("confirmator_order",JSON.stringify(j))}),[j]);var h=Object(o.b)().enqueueSnackbar;function O(e){return nt.transformToText(e,(function(e){return h(e,{autoHideDuration:750})}))}var v=Object(r.useRef)(null),g=Object(r.useRef)(null);function y(e){var t=new nt(Object(x.a)(Object(x.a)({},j),{},Object(f.a)({},e.target.name,"checkbox"===e.target.type?e.target.checked:e.target.value)));return m(t)}function k(e){a(Object(x.a)(Object(x.a)({},n),{},{id:e.id||null,text:e.text||e}))}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;nt.setupOrderFromText(e.text).then((function(t){return m(t),l({id:e.id,text:O(t)})})).catch((function(e){return h(e.message,{variant:"error"})}))}return Object(E.jsxs)("div",{className:"flex-container",children:[Object(E.jsx)($,{elementRef:v,rawOrderText:n.text,handleClick:k}),Object(E.jsx)(D,{order:j,handleChange:y}),Object(E.jsx)(ae,{elementRef:g,transformDisabled:!n.text,copyDisabled:!s.text,handleOrderTransformFromText:w,handleOrderTransformFromEditor:function(){return l({id:n.id,text:O(j)})}}),Object(E.jsx)(G,{elementRef:g,transformedOrderText:s.text,handleClick:function(e){l(Object(x.a)(Object(x.a)({},s),{},{text:e}))}}),Object(E.jsx)(A,{handleChange:y,order:j}),Object(E.jsx)(J,{order:j,shouldValidate:s.text}),Object(E.jsx)(ct,{order:j,orderId:n.id,transformedOrder:s,handleResetClick:function(){a({text:"",id:null}),l({text:"",id:null}),m(nt.default())},orderPoolUrl:"/confirmator/order-pool"}),Object(E.jsx)(b.b,{path:"/confirmator/order-pool",children:Object(E.jsx)(wt,{handleExport:function(e){k(e),w(e),setTimeout((function(){return v.current.scrollIntoView({smooth:!0})}),700)}})})]})}n(285);var Nt=n.p+"static/media/paku24-logo.7602fc02.png";function St(e){var t=e.isLogged;return Object(E.jsx)("div",{className:"logo",children:Object(E.jsxs)("div",{children:[Object(E.jsx)(s.b,{to:t?"/confirmator":"/login",children:Object(E.jsx)("img",{src:Nt,alt:"Logo",width:"125px"})}),Object(E.jsx)("span",{className:"text",children:"CONFIRMATOR"})]})})}var Tt="/api/login",Et=pe.a.create();function Dt(){return(Dt=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Et.post(Tt,t).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zt(){return(zt=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Et.post("".concat(Tt,"/token"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Et.interceptors.response.use((function(e){return e}),function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,"access token expired"!==t.response.data.error){e.next=13;break}return e.prev=2,e.next=5,pe.a.post("/api/token");case 5:return e.next=7,pe.a.post("/api/token/is-new");case 7:return e.abrupt("return",Et(n));case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",e.t0);case 13:return e.abrupt("return",Promise.reject(t));case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}());var It={loginWithCredentials:function(e){return Dt.apply(this,arguments)},loginWithAccessToken:function(){return zt.apply(this,arguments)}},Lt=n(153),Ft=n.n(Lt),Pt=function(e){var t=e.notification,n="black";return t.toLowerCase().includes("error")&&(n="red"),Object(E.jsx)(E.Fragment,{children:t?Object(E.jsxs)("div",{style:{backgroundColor:"white",color:n,padding:"10px",width:"80%",borderBottom:"3px solid darkgrey",fontSize:"small",display:"flex",alignItems:"center",marginBottom:"10px"},children:[Object(E.jsx)(Ft.a,{}),Object(E.jsx)("span",{style:{marginLeft:"10px"},children:t})]}):null})};function Ut(e){var t,n=e.setUser,a={marginBottom:"7px",backgroundColor:"white"},c=Object(b.g)(),i=null===c||void 0===c||null===(t=c.location.state)||void 0===t?void 0:t.referrer,o=Object(r.useState)(""),l=Object(p.a)(o,2),u=l[0],d=l[1],h=Object(r.useState)(""),f=Object(p.a)(h,2),x=f[0],v=f[1],g=Object(r.useState)(!1),y=Object(p.a)(g,2),k=y[0],w=y[1],C=Object(r.useState)(!1),N=Object(p.a)(C,2),S=N[0],T=N[1],D=Object(r.useState)(""),z=Object(p.a)(D,2),I=z[0],L=z[1];function F(){return(F=Object(m.a)(j.a.mark((function e(t){var r,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),L("Working..."),e.prev=2,e.next=5,It.loginWithCredentials({username:u,password:x});case 5:r=e.sent,a=r.user,L("Done"),c.push(i||"/confirmator"),n(a),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(2),T(!0),w(!0),setTimeout((function(){return w(!1)}),2e3),L("Error: ".concat(null===(s=e.t0.response)||void 0===s?void 0:s.data.error));case 18:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return Object(E.jsx)("div",{style:{margin:"30px 5px"},children:Object(E.jsxs)("div",{style:{width:"95%",margin:"0 auto",padding:20,backgroundColor:"lightgrey",borderBottom:"4px solid darkgrey"},children:[Object(E.jsxs)("div",{style:{color:"black",fontSize:"1.3rem",letterSpacing:"0.7px",marginTop:"10px",marginBottom:"15px"},children:["LOGIN",Object(E.jsxs)("span",{style:{color:"black",fontSize:"1.0rem",letterSpacing:"0.2px"},children:[" ","or ",Object(E.jsx)(s.b,{to:"/register",children:"request access"})]})]}),Object(E.jsx)(Pt,{notification:I}),Object(E.jsxs)("form",{onSubmit:function(e){return F.apply(this,arguments)},style:{paddingBottom:"10px",height:"80%",display:"flex",flexFlow:"column wrap",justifyContent:"space-evenly"},children:[Object(E.jsx)(O.a,{className:"flex-item",style:a,error:S,required:!0,name:"username",value:u,onChange:function(e){var t=e.target;return d(t.value)},label:"Username",variant:"filled",size:"small"}),Object(E.jsx)(O.a,{className:"flex-item",style:a,error:S,type:"password",required:!0,value:x,name:"password",onChange:function(e){var t=e.target;return v(t.value)},label:"Password",variant:"filled",size:"small"}),Object(E.jsx)(K.a,{className:"flex-item",style:a,type:"submit",disabled:k,variant:"contained",size:"small",children:"Login"})]})]})})}function At(){var e={marginBottom:"7px",backgroundColor:"white"},t=Object(r.useState)(""),n=Object(p.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(""),o=Object(p.a)(i,2),l=o[0],u=o[1],d=Object(r.useState)(""),b=Object(p.a)(d,2),h=b[0],f=b[1],x=Object(r.useState)(""),v=Object(p.a)(x,2),g=v[0],y=v[1],k=Object(r.useState)(!1),w=Object(p.a)(k,2),C=w[0],N=w[1];function S(e){return T.apply(this,arguments)}function T(){return(T=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pe.a.post("/api/registration/request-access",t).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(m.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),N(!0),y("Working..."),e.prev=3,e.next=6,S({name:a,email:l,purpose:h});case 6:n=e.sent,y(null===n||void 0===n?void 0:n.message),c(""),u(""),f(""),N(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),N(!1),y("Error: ".concat(null===e.t0||void 0===e.t0||null===(r=e.t0.response.data)||void 0===r?void 0:r.error));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})))).apply(this,arguments)}return Object(E.jsx)("div",{style:{margin:"30px 5px"},children:Object(E.jsxs)("div",{style:{width:"95%",padding:20,margin:"0 auto",backgroundColor:"lightgrey",borderBottom:"4px solid darkgrey"},children:[Object(E.jsxs)("div",{style:{color:"black",fontSize:"1.3rem",letterSpacing:"0.7px",marginTop:"10px",marginBottom:"15px"},children:["REQUEST ACCESS",Object(E.jsxs)("span",{style:{color:"black",fontSize:"1.0rem",letterSpacing:"0.2px"},children:[" ","or ",Object(E.jsx)(s.b,{to:"/login",children:"login"})]})]}),Object(E.jsx)(Pt,{notification:g}),Object(E.jsxs)("form",{onSubmit:function(e){return D.apply(this,arguments)},style:{paddingBottom:"10px",height:"80%",display:"flex",flexFlow:"column wrap",justifyContent:"space-evenly"},children:[Object(E.jsx)(O.a,{style:e,required:!0,name:"name",value:a,onChange:function(e){var t=e.target;return c(t.value)},label:"Name",variant:"filled",size:"small"}),Object(E.jsx)(O.a,{style:e,type:"email",required:!0,value:l,name:"email",onChange:function(e){var t=e.target;return u(t.value)},label:"Email",variant:"filled",size:"small"}),Object(E.jsx)(O.a,{style:e,type:"text",required:!0,multiline:!0,rows:"3",value:h,name:"purpose",onChange:function(e){var t=e.target;return f(t.value)},label:"Why do you want to use this application?",variant:"filled",size:"small"}),Object(E.jsx)(K.a,{style:e,type:"submit",disabled:C,variant:"contained",size:"small",children:"Send request"})]})]})})}n(286);var Rt="/api/logout";function Mt(){return(Mt=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pe.a.post(Rt).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Wt={logout:function(){return Mt.apply(this,arguments)}},qt=n(154),Bt=n.n(qt);function Jt(e){var t=e.handleClick;return Object(E.jsxs)(K.a,{style:{backgroundColor:"lightgrey"},variant:"outlined",size:"small",onClick:t,children:["Logout ",Object(E.jsx)(Bt.a,{})]})}function Ht(e){var t=e.user,n=e.logoutUser;return Object(E.jsxs)("div",{style:{backgroundColor:"darkgrey",padding:"15px",marginTop:"40px",display:"flex",justifyContent:"space-between",borderTop:"3.5px solid lightgrey"},children:[Object(E.jsx)("div",{style:{paddingTop:"2px",marginRight:"20px"},children:Object(E.jsxs)("span",{style:{fontFamily:"monospace"},children:[" ",t.username,Object(E.jsx)("br",{}),t.name]})}),Object(E.jsx)(Jt,{handleClick:function(){return Wt.logout().then(n)}})]})}function Kt(e){var t=e.error;return Object(E.jsxs)("div",{role:"alert",children:[Object(E.jsx)("p",{children:"Something went wrong:"}),Object(E.jsx)("pre",{style:{color:"red"},children:t.message})]})}function Xt(e){var t,n=e.user,r=e.setUser,a=e.children,c=Object(b.g)();null!==n&&"Loading"!==n||(t=c.location.pathname);var i="Loading"===n,s=null===n&&Object(E.jsx)(b.a,{to:{pathname:"/login",state:{referrer:t}}});return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(Ot,{loading:i,redirectComponent:s,children:a}),Object(E.jsx)(b.b,{path:"/login",children:null===n?Object(E.jsx)(Ut,{setUser:r}):Object(E.jsx)(b.a,{to:"/confirmator"})})]})}var Yt=function(){var e=Object(r.useState)("Loading"),t=Object(p.a)(e,2),n=t[0],a=t[1],c=Object(o.b)().enqueueSnackbar,i=Object(b.g)();return Object(r.useEffect)(Object(m.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Oe.setupInterceptor({logout:function(){return a(null)},notificate:function(){return c("You were logged out for security reasons. Your work has been saved. Login to continue.",{variant:"warning",autoHideDuration:1e4})}}),e.prev=1,e.next=4,It.loginWithAccessToken();case 4:return t=e.sent,n=t.user,i.push("/confirmator"),e.abrupt("return",a(n));case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",a(null));case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),[]),Object(E.jsx)("div",{className:"container",children:Object(E.jsxs)(h.ErrorBoundary,{FallbackComponent:Kt,children:[Object(E.jsx)(St,{isLogged:null!==n&&"Loading"!==n}),Object(E.jsxs)(b.d,{children:[Object(E.jsx)(b.b,{path:"/register",children:Object(E.jsx)(At,{})}),Object(E.jsx)(b.b,{path:"/",children:Object(E.jsx)(Xt,{user:n,setUser:a,children:Object(E.jsxs)(b.b,{path:"/confirmator",children:[Object(E.jsx)(Ct,{}),Object(E.jsx)(Ht,{user:n,logoutUser:function(){return a(null)}})]})})})]})]})})},Vt=(n(287),a.a.createRef());i.a.render(Object(E.jsx)(a.a.StrictMode,{children:Object(E.jsx)(s.a,{basename:"/app",children:Object(E.jsx)(o.a,{action:function(e){return Object(E.jsx)(u.a,{onClick:function(){Vt.current.closeSnackbar(e)}})},ref:Vt,maxSnack:3,dense:!0,autoHideDuration:3500,anchorOrigin:{horizontal:"left",vertical:"top"},children:Object(E.jsx)(Yt,{})})})}),document.getElementById("root"))},54:function(e){e.exports=JSON.parse('[{"id":1,"name":"Pakettiauto ja kuljettaja","price":30,"priceXL":40},{"id":2,"name":"Pakettiauto ja muuttomies","price":60,"priceXL":60},{"id":3,"name":"Pakettiauto ja kaksi muuttomiest\xe4","price":90,"priceXL":90},{"id":4,"name":"Nouto/tyhjennyspalvelu yhdell\xe4 kantajalla","price":40,"priceXL":40},{"id":5,"name":"Nouto/tyhjennyspalvelu kahdella kantajalla","price":70,"priceXL":70}]')},61:function(e){e.exports=JSON.parse('[{"id":1,"name":"Maksukortti"},{"id":2,"name":"K\xe4teinen"},{"id":3,"name":"Lasku/Osamaksu"},{"id":4,"name":"Bank card"},{"id":5,"name":"Cash"},{"id":6,"name":"Invoice/Instalment payment"}]')},67:function(e){e.exports=JSON.parse('{"morning":{"name":"Aamulis\xe4","amount":20},"night":{"name":"Y\xf6lis\xe4","amount":20},"holiday":{"name":"Pyh\xe4lis\xe4","amount":15},"weekend":{"name":"Viikonloppulis\xe4","amount":15},"firstOrLastDayOfTheMonth":{"name":"Kuunvaihdelis\xe4","amount":15},"bill":{"name":"Laskulis\xe4","amount":14}}')}},[[288,1,2]]]);
//# sourceMappingURL=main.464a99e1.chunk.js.map