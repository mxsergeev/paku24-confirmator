(this["webpackJsonppaku24-confirmator-front"]=this["webpackJsonppaku24-confirmator-front"]||[]).push([[0],{146:function(e){e.exports=JSON.parse('{"insideCapital":"insideCapital","outsideCapital":"outsideCapital","fromCapitalToOutside":"fromCapitalToOutside","fromOutsideToCapital":"fromOutsideToCapital"}')},173:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},280:function(e,t,n){},281:function(e,t,n){},282:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),i=n.n(c),s=n(37),o=n(8),l=n.n(o),d=n(12),u=n(11),j=n(19),m=n(153),h=n(41),p=n(10),b=n(25),f=(n(173),n(335)),x=n(138),O=n(291),v=n(134),g=n(20),y=n(333),k=n(53),w=n(58),C=n(1);function N(e){var t=e.order,n=e.handleChange,r={marginTop:5},c={marginLeft:5,marginRight:5},i=Object(a.useState)(t.dateTime),s=Object(u.a)(i,2),o=s[0],l=s[1];return Object(a.useEffect)((function(){n({target:{name:"dateTime",value:o}})}),[o]),Object(C.jsxs)("div",{className:"basic-flex",style:{marginTop:"5px"},children:[Object(C.jsxs)("div",{className:"flex-100-space-between flex-item",style:c,children:[Object(C.jsx)(g.a,{utils:v.a,children:Object(C.jsx)(y.a,{ampm:!1,format:"DD-MM-YYYY HH:mm",minutesStep:15,style:c,className:"time-duration",name:"dateTime",value:t.dateTime,onChange:l,DialogProps:{disableScrollLock:!0}})}),Object(C.jsxs)(x.a,{className:"time-duration",style:Object(p.a)(Object(p.a)({},c),{},{paddingLeft:10}),name:"duration",value:null===t||void 0===t?void 0:t.duration,onChange:n,children:[Object(C.jsx)("option",{value:1,children:"1h"}),Object(C.jsx)("option",{value:1.5,children:"1.5h"}),Object(C.jsx)("option",{value:2,children:"2h"}),Object(C.jsx)("option",{value:2.5,children:"2.5h"}),Object(C.jsx)("option",{value:3,children:"3h"}),Object(C.jsx)("option",{value:3.5,children:"3.5h"}),Object(C.jsx)("option",{value:4,children:"4h"}),Object(C.jsx)("option",{value:4.5,children:"4.5h"}),Object(C.jsx)("option",{value:5,children:"5h"}),Object(C.jsx)("option",{value:5.5,children:"5.5h"}),Object(C.jsx)("option",{value:6,children:"6h"}),Object(C.jsx)("option",{value:6.5,children:"6.5h"}),Object(C.jsx)("option",{value:7,children:"7h"}),Object(C.jsx)("option",{value:7.5,children:"7.5h"}),Object(C.jsx)("option",{value:8,children:"8h"}),Object(C.jsx)("option",{value:8.5,children:"8.5h"}),Object(C.jsx)("option",{value:9,children:"9h"}),Object(C.jsx)("option",{value:9.5,children:"9.5h"}),Object(C.jsx)("option",{value:10,children:"10h"})]})]}),Object(C.jsx)(x.a,{fullWidth:!0,style:c,className:"flex-item",name:"serviceName",value:null===t||void 0===t?void 0:t.serviceName,onChange:n,children:k.map((function(e){return Object(C.jsx)("option",{value:e.name,children:e.name},e.id)}))}),Object(C.jsx)(x.a,{fullWidth:!0,style:c,className:"flex-item",name:"paymentType",value:null===t||void 0===t?void 0:t.paymentType,onChange:n,children:w.map((function(e){var t=e.name,n=e.id;return Object(C.jsx)("option",{value:t,children:t},n)}))}),Object(C.jsx)(f.a,{fullWidth:!0,style:r,className:"flex-item",required:!0,name:"address",value:null===t||void 0===t?void 0:t.address,onChange:n,label:"Address",variant:"outlined",size:"small"}),Object(C.jsx)(f.a,{fullWidth:!0,multiline:!0,style:r,className:"flex-item",name:"destination",value:null===t||void 0===t?void 0:t.destination,onChange:n,label:"Destination",variant:"outlined",size:"small"}),Object(C.jsx)(f.a,{fullWidth:!0,required:!0,style:r,className:"flex-item",name:"name",value:null===t||void 0===t?void 0:t.name,onChange:n,label:"Name",variant:"outlined",size:"small"}),Object(C.jsx)(f.a,{fullWidth:!0,style:r,className:"flex-item",name:"email",value:null===t||void 0===t?void 0:t.email,onChange:n,type:"email",label:"Email",variant:"outlined",size:"small"}),Object(C.jsx)(f.a,{fullWidth:!0,style:r,className:"flex-item",required:!0,name:"phone",value:null===t||void 0===t?void 0:t.phone,onChange:n,label:"Phonenumber",variant:"outlined",size:"small"}),Object(C.jsx)(O.a,{style:r,className:"flex-item textarea-2",rowsMin:3,cols:27,name:"comment",value:null===t||void 0===t?void 0:t.comment,placeholder:"Additional information.",onChange:n})]})}var T=n(328),S=n(327),E=n(331),D=n(338),z=n(337),I=n(340);function L(e){var t=e.handleChange,n=e.order;return Object(C.jsxs)("div",{className:"checkbox-container",children:[Object(C.jsxs)(S.a,{className:"checkbox-distance flex-item",hiddenLabel:!1,size:"small",children:[Object(C.jsx)(T.a,{component:"legend",children:"Pick one:"}),Object(C.jsxs)(I.a,{value:n.distance,onChange:t,children:[Object(C.jsx)(E.a,{name:"distance",value:"insideCapital",control:Object(C.jsx)(z.a,{color:"default"}),label:"\ud83c\udfd9 Inside capital"}),Object(C.jsx)(E.a,{name:"distance",value:"outsideCapital",control:Object(C.jsx)(z.a,{color:"default"}),label:"\ud83c\udfde Outside capital"}),Object(C.jsx)(E.a,{name:"distance",value:"fromCapitalToOutside",control:Object(C.jsx)(z.a,{color:"default"}),label:"\ud83c\udfd9->\ud83c\udfde From capital"}),Object(C.jsx)(E.a,{name:"distance",value:"fromOutsideToCapital",control:Object(C.jsx)(z.a,{color:"default"}),label:"\ud83c\udfde->\ud83c\udfd9 To capital"})]})]}),Object(C.jsxs)(S.a,{className:"basic-flex",size:"small",children:[Object(C.jsx)(E.a,{size:"small",className:"flex-item",control:Object(C.jsx)(D.a,{checked:n.hsy,onChange:t,color:"primary"}),name:"hsy",label:"\u267b HSY",labelPlacement:"start"}),Object(C.jsx)(E.a,{className:"flex-item",control:Object(C.jsx)(D.a,{checked:n.altColorPalette,onChange:t,color:"primary"}),name:"altColorPalette",label:"Second car",labelPlacement:"start"}),Object(C.jsx)(E.a,{className:"flex-item",control:Object(C.jsx)(D.a,{checked:n.XL,onChange:t,color:"primary"}),name:"XL",label:"XL",labelPlacement:"start"})]})]})}var F=n(71),P=n.n(F),A=n(139),U=n.n(A);function R(e){var t=e.validationArray,n={color:"red"};return Object(C.jsx)(C.Fragment,{children:t.map((function(e){return e.isError?Object(C.jsxs)("div",{children:[Object(C.jsxs)("span",{style:n,children:[e.name," "]}),e.message]},e.id):null}))})}function M(e){var t=e.order,n=e.shouldValidate,r=Object(a.useState)([]),c=Object(u.a)(r,2),i=c[0],s=c[1];Object(a.useEffect)((function(){if(n){var e=[{id:1,name:"Date and time",isError:P.a.isBefore(t.dateTime.toISOString(),(new Date).toISOString()),message:"might have some problems. Check to be sure: ".concat("".concat(t.confirmationDateString," ").concat(t.time)||"---")},{id:2,name:"Address",isError:P.a.isEmpty(t.address),message:"is missing"},{id:3,name:"Phonenumber",isError:!P.a.isMobilePhone(t.phone,["fi-FI","es-ES","sv-SE"]),message:"is missing or is incorrect: ".concat(t.phone||"---")},{id:4,name:"Email",isError:!P.a.isEmail(t.email),message:"is missing or is incorrect: ".concat(t.email||"---")}];s(e)}}),[t.dateTime,t.phone,t.address,t.email,n]);var o=i.some((function(e){return e.isError}));return Object(C.jsx)(C.Fragment,{children:n&&o&&Object(C.jsx)("div",{style:{borderTop:"1px solid gray",borderBottom:"1px solid gray",padding:"15px 0 15px 0",margin:"10px 0 10px 0"},className:"flex-100-space-between",children:Object(C.jsxs)("div",{children:[Object(C.jsx)(U.a,{}),Object(C.jsx)(R,{validationArray:i})]})})})}var W=n(62),B=n(326),q=n(292),J=n(140),K=n.n(J),X=(n(258),function(e,t){return function(n){var r=n.content,c=n.handleUpdate,i=Object(W.a)(n,["content","handleUpdate"]),s=Object(a.useState)(!1),o=Object(u.a)(s,2),l=o[0],d=o[1],j=Object(a.useState)(r),m=Object(u.a)(j,2),h=m[0],b=m[1],f=Object(a.useState)(h),x=Object(u.a)(f,2),O=x[0],v=x[1];function g(e){v(e.target.value)}function y(){v(h),d(!l)}function k(){b(O),c(O),d(!l)}function w(){d(!l)}return Object(C.jsx)(C.Fragment,{children:l?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(e,Object(p.a)({content:O,handleChange:g},i)),Object(C.jsxs)("div",{className:"buttons-block",children:[Object(C.jsx)(B.a,{size:"small",onClick:y,children:"Cancel"}),Object(C.jsx)(B.a,{className:"primary",size:"small",onClick:k,children:"Save"})]})]}):Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(t,Object(p.a)({content:r,button:Object(C.jsx)("span",{children:Object(C.jsx)(q.a,{size:"small",onClick:w,children:Object(C.jsx)(K.a,{style:{width:"20px"}})})})},i))})})}});function Y(e){var t=e.handleClick,n=e.rawOrderText,a=e.elementRef,r=X((function(e){var t=e.handleChange,n=e.content;return Object(C.jsx)(O.a,{onChange:t,value:n,style:{marginTop:"10px"},className:"width-100",rowsMin:5,cols:40,placeholder:"Raw order here."})}),(function(e){var t=e.button;return Object(C.jsxs)("div",{ref:a,className:"not-editable-container",children:["Raw order",t]})}));return Object(C.jsx)(r,{style:{width:"max-content"},handleUpdate:t,content:n})}n(259);function H(e){var t=e.elementRef,n=e.handleClick,a=e.transformedOrderText,r=X((function(e){var n=e.handleChange,a=e.content;return Object(C.jsx)(O.a,{onChange:n,value:a,ref:t,style:{marginTop:"10px"},className:"width-100",rowsMin:5,cols:40,placeholder:"Transformed order."})}),(function(e){var n=e.content,r=e.button;return Object(C.jsxs)("div",{ref:t,style:{width:a&&"100%",marginTop:"12px"},className:"not-editable-container",children:[0===n.length?"Transformed order":Object(C.jsx)("div",{className:"text-container-with-scroll",children:n.split("\n").map((function(e,t){return Object(C.jsx)("div",{children:e},t)}))}),r]})}));return Object(C.jsx)(r,{handleUpdate:n,content:a})}var V=n(141),$=n.n(V);function _(e){var t=e.handleClick,n=e.text,a=void 0===n?"Transform":n,r=Object(W.a)(e,["handleClick","text"]);return Object(C.jsxs)(B.a,Object(p.a)(Object(p.a)({className:"button-one-third flex-item",variant:"outlined",size:"small",style:{fontSize:"0.8rem",padding:"1px"},onClick:function(){return t()}},r),{},{children:[Object(C.jsx)($.a,{}),a]}))}var G=n(142),Q=n.n(G);function Z(e){var t=e.elementRef,n=e.disabled;return Object(C.jsxs)(B.a,{disabled:n,className:"button-one-third flex-item",variant:"outlined",size:"small",onClick:function(){!function(){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t.current.innerText||t.current.defaultValue,e.select(),document.execCommand("copy"),document.body.removeChild(e)}(),b.a.info("Copied!",500)},children:["Copy ",Object(C.jsx)(Q.a,{})]})}function ee(e){var t=e.handleOrderTransformFromText,n=e.handleOrderTransformFromEditor,a=e.transformDisabled,r=e.copyDisabled,c=e.elementRef;return Object(C.jsx)("div",{className:"order-operations",children:Object(C.jsxs)("div",{className:"block",children:[Object(C.jsx)(Z,{disabled:r,elementRef:c}),Object(C.jsx)(_,{text:"from text",disabled:a,handleClick:t}),Object(C.jsx)(_,{text:"from editor",handleClick:n})]})})}var te=n(143),ne=n.n(te);function ae(e){var t=e.handleClick,n=e.className;return Object(C.jsxs)(B.a,{className:n,variant:"contained",size:"small",onClick:t,children:["New order ",Object(C.jsx)(ne.a,{})]})}function re(e){var t=e.className,n=Object(j.g)();return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(B.a,{size:"small",className:t,variant:"contained",onClick:function(){n.push("/order-pool")},children:"Order Pool"})})}function ce(e){var t=e.text,n=e.className,a=Object(W.a)(e,["text","className"]);return Object(C.jsx)("div",Object(p.a)(Object(p.a)({className:"message ".concat(n)},a),{},{children:t}))}var ie=n(144),se=n.n(ie);function oe(e){var t=e.handleClick,n=e.isDisabled,a=e.grayScale,r=e.content,c=e.className,i=a&&{color:"grey"};return Object(C.jsx)(B.a,{disabled:n,className:c,variant:"contained",size:"small",onClick:t,children:Object(C.jsx)("span",{style:Object(p.a)({display:"flex"},i),children:r})})}var le=n(60),de=n.n(le),ue="/api/token";function je(){return(je=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.post(ue);case 2:if(n=e.sent,!(null===(t=n.response)||void 0===t?void 0:t.data.error)){e.next=5;break}return e.abrupt("return",n);case 5:return e.next=7,pe.axiosInstance.post("".concat(ue,"/is-new"));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me={refreshTokens:function(){return je.apply(this,arguments)}},he=de.a.create();var pe={axiosInstance:he,setupInterceptor:function(e){he.interceptors.response.use((function(e){return e}),function(){var t=Object(d.a)(l.a.mark((function t(n){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.config,"access token expired"!==n.response.data.error){t.next=8;break}return t.next=4,me.refreshTokens();case 4:if(!t.sent){t.next=7;break}return t.abrupt("return",null);case 7:return t.abrupt("return",he(a));case 8:if("refresh token expired"!==n.response.data.error&&"invalid refresh token"!==n.response.data.error&&"token missing"!==n.response.data.error){t.next=11;break}return e.logout(),t.abrupt("return",n);case 11:return 429===n.response.status&&setTimeout((function(){return null}),1500),t.abrupt("return",Promise.reject(n));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},be="/api/email";function fe(){return(fe=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.post("".concat(be,"/send-confirmation"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe="email";function Oe(e){var t=e.email,n=e.order,a=e.transformedOrderText,r=e.statusText,c=e.isDisabled,i=e.changeStatus,s=e.className;var o=r||Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("span",{children:"Send"})," ",Object(C.jsx)(se.a,{})]});return Object(C.jsx)(oe,{className:s,isDisabled:c,grayScale:null!==r,handleClick:function(){return t&&a?(i(xe,"Working",!0),function(e){return fe.apply(this,arguments)}({orderDetails:a,order:n,email:t}).then((function(e){i(xe,"Done",!0),b.a.info(e.message,500)})).catch((function(e){i(xe,"Error",!1),b.a.fail(e.response.data.error)}))):b.a.fail("No confirmation found or recipients defined.",1e3)},content:o})}var ve=n(145),ge=n.n(ve),ye="/api/sms";function ke(e){return we.apply(this,arguments)}function we(){return(we=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.post(ye,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ce="sms";function Ne(e){var t=e.phone,n=e.transformedOrderText,a=e.statusText,r=e.isDisabled,c=e.changeStatus,i=e.className;function s(){return(s=Object(d.a)(l.a.mark((function e(){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(a=n)||!t){e.next=9;break}return c(Ce,"Working",!0),e.next=6,ke({msg:a,phone:t});case 6:r=e.sent,c(Ce,"Done",!0),b.a.info("".concat(r.message),500);case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),c(Ce,"Error",!1),b.a.fail(null===(i=e.t0.response)||void 0===i?void 0:i.data.error,2e3);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var o=a||Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("span",{children:"Send"})," ",Object(C.jsx)(ge.a,{})]});return Object(C.jsx)(oe,{className:i,isDisabled:r,grayScale:null!==a,handleClick:function(){return s.apply(this,arguments)},content:o})}var Te=n(147),Se=n.n(Te),Ee="/api/calendar";function De(e){return ze.apply(this,arguments)}function ze(){return(ze=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.post(Ee,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ie="/api/order-pool";function Le(e,t){return t.map((function(n,a){var r=a===t.length-1;return"".concat(e,"[]=").concat(n).concat(r?"":"&")})).join("")}function Fe(e){var t=e.query,n=e.orders;return new Promise((function(e){e(sessionStorage.setItem("order-pool/".concat(t),JSON.stringify({validUntil:Date.now()+3e5,orders:n})))}))}function Pe(e){return new Promise((function(t){t(JSON.parse(sessionStorage.getItem("order-pool/".concat(e))).orders)}))}function Ae(e){return new Promise((function(t){try{t(JSON.parse(sessionStorage.getItem("order-pool/".concat(e))).validUntil>Date.now())}catch(n){t(!1)}}))}function Ue(){return(Ue=Object(d.a)(l.a.mark((function e(){var t,n,a,r,c,i,s=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:[1],n=s.length>1&&void 0!==s[1]?s[1]:{deleted:!1,forceUpdate:!1},a=n.deleted,r=n.forceUpdate,c="".concat(a?"deleted=true":"deleted=false","&").concat(Le("pages",t)),e.t0=!r,!e.t0){e.next=9;break}return e.next=8,Ae(c);case 8:e.t0=e.sent;case 9:if(!e.t0){e.next=11;break}return e.abrupt("return",Pe(c));case 11:return i="".concat(Ie,"/?").concat(c),e.abrupt("return",pe.axiosInstance.get(i).then((function(e){var t=(null===e||void 0===e?void 0:e.data).orders;return Fe({query:c,orders:t}),t})));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(){return(Re=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pe.axiosInstance.put("".concat(Ie,"/confirm/").concat(t)).then((function(e){return null===e||void 0===e?void 0:e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return(Me=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.delete("".concat(Ie,"/delete/").concat(t));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function We(){return(We=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.put("".concat(Ie,"/retrieve/").concat(t));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Be={get:function(){return Ue.apply(this,arguments)},confirm:function(e){return Re.apply(this,arguments)},remove:function(e){return Me.apply(this,arguments)},retrieve:function(e){return We.apply(this,arguments)}},qe=n(100),Je=n(85),Ke=n(86),Xe=n(88),Ye=n(65);function He(e){return"Cannot find ".concat(e)}var Ve=function(){function e(t){Object(Je.a)(this,e),this.textOrder=e.initialCleanup(t)}return Object(Ke.a)(e,[{key:"dateTime",get:function(){var e=/(?<=Date and time: \w+, )\w+ \d+(th|rd|st|nd)? \w+/.exec(this.textOrder);if(!e)throw new Error(He("date"));var t=new Date("".concat(e[0].replace(/th|rd|st|nd/,""),"Z")),n=/\d+:\d+/.exec(this.textOrder)[0];return new Date("\n    ".concat(t.getFullYear(),"\n    ").concat(t.getMonth()+1,"\n    ").concat(t.getDate(),"\n    ").concat(n))}},{key:"duration",get:function(){var e=/\d+(\.\d+)?(?=\sh.)/.exec(this.textOrder);if(!e)throw new Error(He("duration"));return e[0]}},{key:"paymentType",get:function(){var e="Payment Type: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("PRICE"),a=this.textOrder.slice(t,n).trim(),r=a.match(/\W+/g).filter((function(e){return"/"!==e&&" "!==e&&"\xe4"!==e})),c=a.indexOf(r[0].trim()),i=a.slice(0,c).trim();if(!i)throw new Error(He("payment type"));if(!w.map((function(e){return e.name})).includes(i))throw new Error("Unrecognized payment type");return i}},{key:"movingBoxesPrice",get:function(){var e=this.textOrder.indexOf("\u2014 Price: "),t=this.textOrder.indexOf("\u2014 Booking time start"),n=this.textOrder.slice(e,t);return n&&n.match(/\d+/)[0]}},{key:"serviceName",get:function(){var e="Service: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("Accessories"),a=this.textOrder.slice(t,n).trim();if(!a)throw new Error(He("service name"));if(!k.find((function(e){return e.name===a})))throw new Error("Unrecognized service name");return a}},{key:"addresses",get:function(){var e=this,t=["End location","Name"],n=[];return["Start location:","End location:"].forEach((function(a,r){var c=e.textOrder.indexOf(a)+a.length,i=e.textOrder.indexOf(t[r]),s=e.textOrder.slice(c,i).replaceAll(",","").trim(),o=s.slice(0,s.indexOf(" / ")),l=s.match(/\d{5}/);l=l&&l[0]||"";var d=s.slice(s.indexOf(" / ")+" / ".length),u=o.match(/\D+/);u=u&&u[0];var j=d.replace(l,"");if(j=j||null,(!/\d+/.test(d)||d.includes(l)&&d.length<15)&&(j=o.replace(l,""),u=(u=d.match(/\D+/))&&u[0]),j.includes(u)&&(j=j.replace(u,"")),0===r&&!j)throw new Error(He("address"));n.push("".concat(j,", ").concat(l," ").concat(u).replace(/\s+/g," ").trim())})),n}},{key:"address",get:function(){return this.addresses[0]}},{key:"destination",get:function(){return Object(u.a)(this.addresses,2)[1]}},{key:"name",get:function(){var e="Name: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("Email"),a=this.textOrder.slice(t,n).trim();if(!a)throw new Error(He("name"));return a}},{key:"email",get:function(){var e=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.exec(this.textOrder);if(!e)throw new Error(He("email"));return e[0]}},{key:"phone",get:function(){var e=/(?<=Phone: )[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*/.exec(this.textOrder);if(!e)throw new Error(He("phone"));return e[0].trim()}},{key:"comment",get:function(){var e=/(?<=Comment: )(.*\s*)*/.exec(this.textOrder);e=e?e[0]:"";var t=/\n\n\-\-\nT\xe4m\xe4 viesti l\xe4hetettiin sivustolta Paku24\.fi \(https:\/\/paku24\.fi\)/;return t.exec(e)&&(e=e.replace(t,"")),e}}],[{key:"initialCleanup",value:function(e){var t=e.split("\n"),n=[];return t.forEach((function(e){return n.push(e.trim())})),n.join("\n").replaceAll("\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014","").replaceAll("------------------------","")}}]),e}(),$e=n(146),_e={dateTime:new Date,duration:1,serviceName:k[0].name,paymentType:w[0].name,address:"",destination:"",name:"",email:"",phone:"",comment:"",distance:$e.insideCapital,hsy:!1,altColorPalette:!1,XL:!1},Ge=Object.keys(_e),Qe=function(){function e(t){Object(Je.a)(this,e);var n,a=Object(qe.a)(Ge);try{for(a.s();!(n=a.n()).done;){var r,c=n.value;this[c]=null!==(r=t[c])&&void 0!==r?r:_e[c]}}catch(i){a.e(i)}finally{a.f()}this.dateTime=new Date(t.dateTime)}return Object(Ke.a)(e,[{key:"time",get:function(){return this.dateTime.toTimeString().slice(0,5)}},{key:"servicePrice",get:function(){var e=this,t=k.find((function(t){return t.name===e.serviceName}));return this.XL?t.priceXL:t.price}},{key:"ISODateString",get:function(){return"".concat(this.dateTime.toISOString().split("T")[0],"T").concat(this.time)}},{key:"confirmationDateString",get:function(){var e=this.dateTime.getDate(),t=this.dateTime.getMonth()+1,n=this.dateTime.getFullYear();return e<10&&(e="0".concat(e)),t<10&&(t="0".concat(t)),"".concat(e,"-").concat(t,"-").concat(n)}},{key:"fees",get:function(){var e=1*this.time.split(":")[0],t=this.dateTime.getDay(),n=this.dateTime.getDate(),a=[new Date(this.dateTime.getFullYear(),this.dateTime.getMonth()+1,0).getDate(),1],r=6===t||0===t,c=!r&&a.includes(n),i=e<8,s=e>20,o="Lasku"===this.paymentType||"Lasku/Osamaksu"===this.paymentType||"Invoice/Instalment payment"===this.paymentType;return[r&&Ye.weekend,c&&Ye.firstOrLastDayOfTheMonth,i&&Ye.morning,s&&Ye.night,o&&Ye.bill].filter((function(e){return!1!==e}))}},{key:"printFees",value:function(){var e="\n@feeName\n@feeAmount".repeat(this.fees.length);return this.fees.forEach((function(t){e=(e=e.replace("@feeName",t.name.toUpperCase())).replace("@feeAmount","".concat(t.amount,"\u20ac"))})),e}}],[{key:"getEventForCalendar",value:function(e,t){return e.slice(e.indexOf(t))}},{key:"setupOrderFromText",value:function(t){return new Promise((function(n){Object(Xe.a)(t)&&n(new e(JSON.parse(t)));var a,r={},c=new Ve(t),i=Object(qe.a)(Ge);try{for(i.s();!(a=i.n()).done;){var s=a.value;r[s]=c[s]}}catch(o){i.e(o)}finally{i.f()}n(new e(r))}))}},{key:"default",value:function(){return new e(_e)}},{key:"transformToText",value:function(e,t){var n;try{n="VARAUKSEN TIEDOT\n".concat(e.confirmationDateString,"\nALKAMISAIKA\nKlo ").concat(e.time," (+/-15min)\nARVIOITU KESTO\n").concat(e.duration,"h (").concat(e.servicePrice,"\u20ac/h, ").concat(e.serviceName,")\nMAKSUTAPA\n").concat(e.paymentType).concat(e.printFees(),"\nL\xc4HT\xd6PAIKKA\n").concat(e.address,"\n").concat(e.destination.length>5?"M\xc4\xc4R\xc4NP\xc4\xc4\n".concat(e.destination,"\n"):"","NIMI\n").concat(e.name,"\n").concat(e.email?"S\xc4HK\xd6POSTI\n".concat(e.email,"\n"):"","PUHELIN\n").concat(e.phone,"\n").concat(e.comment?"LIS\xc4TIETOJA\n".concat(e.comment,"\n"):""),t("Succesefully formatted!")}catch(a){console.error(a),t(a.message)}return n}}]),e}(),Ze="calendar";function et(e){var t=e.order,n=e.orderId,a=e.transformedOrderText,r=e.statusText,c=e.isDisabled,i=e.changeStatus,s=e.className;function o(){return(o=Object(d.a)(l.a.mark((function e(){var r,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=Qe.getEventForCalendar(a,t.address))){e.next=12;break}return i(Ze,"Working",!0),e.next=6,De({entry:r,order:t,fees:t.fees});case 6:if(c=e.sent,!n){e.next=10;break}return e.next=10,Be.confirm(n);case 10:i(Ze,"Done",!0),b.a.info("".concat(c.message,"\n").concat(c.createdEvent),3e3);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),i(Ze,"Error",!1),b.a.fail(null===(s=e.t0.response)||void 0===s?void 0:s.data.error,2e3);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}var u=r||Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("span",{children:"Add"})," ",Object(C.jsx)(Se.a,{})]});return Object(C.jsx)(oe,{className:s,isDisabled:c,grayScale:null!==r,handleClick:function(){return o.apply(this,arguments)},content:u})}n(280);function tt(e){var t=e.order,n=e.orderId,r=e.transformedOrder,c=e.handleResetClick,i={email:{status:null,disable:!1},sms:{status:null,disable:!1},calendar:{status:null,disable:!1}},s=Object(a.useState)(i),o=Object(u.a)(s,2),l=o[0],d=o[1];function j(e,t,n){d(Object(p.a)(Object(p.a)({},l),{},Object(h.a)({},e,{status:t,disable:n})))}return Object(C.jsxs)("div",{className:"order-operations",children:[function(){var e=l.email.disable||!(t.email&&r.text);return Object(C.jsxs)("div",{className:"block",children:[Object(C.jsx)(ce,{className:"width-75 ".concat(e&&"grayedFont"),text:"Email to: ".concat(t.email)}),Object(C.jsx)(Oe,{className:"width-25",email:t.email,order:t,statusText:l.email.status,isDisabled:e,transformedOrderText:r.text,changeStatus:j})]})}(),function(){var e=l.sms.disable||!(t.phone&&r.text);return Object(C.jsxs)("div",{className:"block",children:[Object(C.jsx)(ce,{className:"width-75 ".concat(e&&"grayedFont"),text:"Sms to: ".concat(t.phone)}),Object(C.jsx)(Ne,{className:"width-25",statusText:l.sms.status,isDisabled:e,phone:t.phone,transformedOrderText:r.text,changeStatus:j})]})}(),function(){var e=l.calendar.disable||!r.text;return Object(C.jsxs)("div",{className:"block",children:[Object(C.jsx)(ae,{className:"share-space",handleClick:function(){d(i),c()}}),Object(C.jsx)(re,{className:"share-space"}),Object(C.jsx)(et,{className:"width-25",statusText:l.calendar.status,isDisabled:e,order:t,orderId:n,transformedOrderText:r.text,changeStatus:j})]})}()]})}var nt=n(339),at=n(330),rt=n(329),ct=n(332),it=n(39);function st(e){var t=e.children,n=e.handleClose,a=Object(it.a)(),r=Object(ct.a)(a.breakpoints.down("sm"));return Object(C.jsx)(C.Fragment,{children:Object(C.jsxs)(nt.a,{fullScreen:r,open:!0,onClose:n,"aria-labelledby":"responsive-dialog-title",disableScrollLock:!0,children:[Object(C.jsx)(rt.a,{children:t}),Object(C.jsx)(at.a,{children:Object(C.jsx)(B.a,{style:{backgroundColor:"white"},variant:"text",onClick:n,children:"Close"})})]})})}var ot=n(87),lt=n(148),dt=n.n(lt),ut=n(150),jt=n.n(ut),mt=n(149),ht=n.n(mt);function pt(e){var t=e.loading,n=e.redirectComponent,a=void 0===n?null:n,r=e.children;return Object(C.jsxs)(C.Fragment,{children:[t&&Object(C.jsx)("p",{children:"Loading..."}),a,!t&&!a&&r]})}function bt(e){var t=e.orders,n=e.handleExport,r=e.handleDeletion,c=e.handleLoadingMoreOrders,i=e.labelForDeletion,s=Object(a.useState)([]),o=Object(u.a)(s,2),l=o[0],d=o[1];function j(e,t){return e.split("\n").map((function(e,n){return Object(C.jsx)("div",{children:e},"".concat(t).concat(n).concat(e))}))}return Object(a.useEffect)((function(){d(t.map((function(e){return{order:Object(p.a)({},e),isNew:new Date(e.date).toDateString()===new Date(Date.now()).toDateString(),className:e.confirmed?"basic-order-style confirmed-order-style":"basic-order-style",hidden:e.confirmed}})))}),[t]),0===t.length?Object(C.jsx)("p",{children:"Nothing found"}):Object(C.jsxs)(C.Fragment,{children:[l.map((function(e){return Object(C.jsxs)("div",{className:"order-pool-list",children:[Object(C.jsxs)("div",{className:"order-top-bar",children:[Object(C.jsxs)("div",{className:"order-status-icons-container",children:[e.isNew&&Object(C.jsx)("span",{className:"order-status-new-order order-status-icon",children:"NEW"}),Object(C.jsxs)("span",{className:"order-status-icon ".concat(e.order.confirmed?"order-status-icon order-status-confirmed":"order-status-icon order-status-notification"),children:[e.order.confirmed?"\u2714":"\u2755"," "]})]}),Object(C.jsxs)("div",{className:"order-actions",children:[Object(C.jsx)(B.a,{style:{padding:0,fontSize:"0.9rem"},variant:"text",size:"small",onClick:function(){return r(e.order.id)},children:i}),Object(C.jsx)(B.a,{style:{padding:0,fontSize:"0.8rem",color:e.order.confirmed&&"var(--brand-color-dark)"},onClick:function(){n(e.order)},variant:"text",size:"small",children:"Export"}),Object(C.jsx)(B.a,{style:{padding:0},variant:"text",size:"small",onClick:function(){return function(e){d(Object(ot.a)(l.map((function(t){return t.order.id===e.order.id?Object(p.a)(Object(p.a)({},e),{},{hidden:!t.hidden,className:t.hidden?"basic-order-style":"basic-order-style confirmed-order-style"}):t}))))}(e)},children:e.hidden?"Show \u2795":"Hide \u2796"})]})]}),Object(C.jsx)("div",{className:e.className,children:Object(Xe.a)(e.order.text)?(t=e.order.text,a=e.order.id,Object.entries(JSON.parse(t)).map((function(e,t){var n=Object(u.a)(e,2),r=n[0],c=n[1];return Object(C.jsxs)("div",{style:{minHeight:"1.2rem",backgroundColor:t%2!==0&&"var(--brand-color-very-light)"},children:[Object(C.jsx)("span",{style:{fontWeight:"bold"},children:r}),":"," ","dateTime"===r?"".concat(new Date(c).toLocaleDateString()," ").concat(new Date(c).toLocaleTimeString().slice(0,5)):c]},"".concat(r).concat(c).concat(a))}))):j(e.order.text,e.order.id)})]},e.order.id);var t,a})),Object(C.jsx)(B.a,{onClick:c,size:"small",children:"Load more"})]})}n(281);var ft="inbox",xt="trashcan";function Ot(e){var t=e.handleExport,n=Object(a.useState)([]),r=Object(u.a)(n,2),c=r[0],i=r[1],s=Object(a.useState)(!0),o=Object(u.a)(s,2),j=o[0],m=o[1],b=Object(a.useState)(ft),x=Object(u.a)(b,2),O=x[0],v=x[1],g=Object(a.useState)({inbox:{pages:[1],searchText:"",showOnlyNotConfirmed:!1},trashcan:{pages:[1],searchText:"",showOnlyNotConfirmed:!1}}),y=Object(u.a)(g,2),k=y[0],w=y[1],N=Object(a.useState)(c),T=Object(u.a)(N,2),S=T[0],E=T[1],D=Object(a.useState)({hasToUpdate:!1,trigger:0}),z=Object(u.a)(D,2),I=z[0],L=z[1],F=Object(a.useState)({inbox:[1],trashcan:[1]}),P=Object(u.a)(F,2),A=P[0],U=P[1],R=c.length,M=c.filter((function(e){return!e.confirmed})).length;function W(e,t,n){var a;return function(e,t){return t?e.filter((function(e){return!1===(null===e||void 0===e?void 0:e.confirmed)})):e}((a=e,n.filter((function(e){return e.text.toLowerCase().includes(null===a||void 0===a?void 0:a.toLowerCase().trim())}))),t)}function J(){return(J=Object(d.a)(l.a.mark((function e(){var t,n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[A[O].length+1],U(Object(p.a)(Object(p.a)({},A),{},Object(h.a)({},O,[].concat(Object(ot.a)(A[O]),t)))),O!==ft){e.next=8;break}return e.next=5,Be.get(t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Be.get(t,{deleted:!0});case 10:e.t0=e.sent;case 11:n=e.t0,a=c.concat(n),i(a),r=W(k[O].searchText,k[O].showOnlyNotConfirmed,a),E(r);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){v(e.target.dataset.tabname)}function X(){return(X=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.remove(t);case 2:i(c.filter((function(e){return e.id!==t}))),E(S.filter((function(e){return e.id!==t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be.retrieve(t);case 2:i(c.filter((function(e){return e.id!==t}))),E(S.filter((function(e){return e.id!==t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)(Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),O!==ft){e.next=7;break}return e.next=4,Be.get(A[O],{forceUpdate:I.hasToUpdate});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,Be.get(A[O],{deleted:!0,forceUpdate:I.hasToUpdate});case 9:e.t0=e.sent;case 10:if(t=e.t0){e.next=13;break}return e.abrupt("return");case 13:i(t),n=W(k[O].searchText,k[O].showOnlyNotConfirmed,t),E(n),m(!1);case 17:case"end":return e.stop()}}),e)}))),[O,I.trigger]);return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)("div",{className:"tab-panel",children:[Object(C.jsx)(B.a,{onClick:K,className:"p-0",variant:"text",size:"small",children:Object(C.jsx)("h3",{"data-tabname":ft,className:O===ft?"tab-panel-item tab-panel-item-selected":"tab-panel-item",children:"Inbox"})}),Object(C.jsx)(B.a,{onClick:K,className:"p-0",variant:"text",size:"small",children:Object(C.jsx)("h3",{"data-tabname":xt,className:O===xt?"tab-panel-item tab-panel-item-selected":"tab-panel-item",children:"Trashcan"})}),Object(C.jsx)(q.a,{style:{marginLeft:"auto",marginRight:"12px"},onClick:function(){L(Object(p.a)(Object(p.a)({},I),{},{trigger:I.trigger+1,hasToUpdate:!0})),setTimeout((function(){return L(Object(p.a)(Object(p.a)({},I),{},{hasToUpdate:!1}))}))},className:"p-0",variant:"text",size:"small",children:Object(C.jsx)(dt.a,{})})]}),Object(C.jsxs)("div",{className:"filters-tab",children:[Object(C.jsxs)("span",{className:"filters-tab-orders-count",children:[S.length,"/",c.length]}),Object(C.jsx)(f.a,{className:"flex-item",type:"text",name:"searchText",placeholder:"Search",value:k[O].searchText,onChange:function(e){var t=k[O];w(Object(p.a)(Object(p.a)({},k),{},Object(h.a)({},O,Object(p.a)(Object(p.a)({},t),{},{searchText:e.target.value}))));var n=W(e.target.value,t.showOnlyNotConfirmed,c);E(n)}}),M>0&&Object(C.jsxs)(B.a,{className:"p-0 filters-tab-orders-status-icon",size:"small",onClick:function(){return function(e){var t=k[O];w(Object(p.a)(Object(p.a)({},k),{},Object(h.a)({},O,Object(p.a)(Object(p.a)({},t),{},{showOnlyNotConfirmed:e}))));var n=W(t.searchText,e,c);E(n)}(!k[O].showOnlyNotConfirmed)},children:[Object(C.jsx)("span",{style:{fontSize:"1rem"},children:k[O].showOnlyNotConfirmed?R:M}),Object(C.jsx)("span",{className:"order-status-icon order-status-notification ".concat(k[O].showOnlyNotConfirmed&&"order-status-icon-selected"),children:k[O].showOnlyNotConfirmed?"\u2714&\u2755":"\u2755"})]})]}),Object(C.jsx)(pt,{loading:j,children:Object(C.jsx)(bt,{orders:S,handleExport:t,labelForDeletion:O===xt?Object(C.jsx)(ht.a,{}):Object(C.jsx)(jt.a,{}),handleDeletion:O===xt?function(e){return Y.apply(this,arguments)}:function(e){return X.apply(this,arguments)},handleLoadingMoreOrders:function(){return J.apply(this,arguments)}})})]})}function vt(e){var t=e.handleExport,n=Object(j.g)(),a=function(){n.goBack()};return Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(j.b,{path:"/order-pool",children:Object(C.jsx)(st,{handleClose:a,children:Object(C.jsx)(Ot,{handleExport:function(e){t(e),a()}})})})})}function gt(){var e=Object(a.useState)({text:"",id:null}),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)({text:"",id:null}),i=Object(u.a)(c,2),s=i[0],o=i[1],l=Object(a.useState)(Qe.default()),d=Object(u.a)(l,2),j=d[0],m=d[1];function f(e){return Qe.transformToText(e,(function(e){return b.a.info(e,500)}))}var x=Object(a.useRef)(null),O=Object(a.useRef)(null);function v(e){var t=new Qe(Object(p.a)(Object(p.a)({},j),{},Object(h.a)({},e.target.name,"checkbox"===e.target.type?e.target.checked:e.target.value)));return m(t)}function g(e){r(Object(p.a)(Object(p.a)({},n),{},{id:e.id||null,text:e.text||e}))}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;Qe.setupOrderFromText(e.text).then((function(t){return m(t),o({id:e.id,text:f(t)})})).catch((function(e){return b.a.fail(e.message,400)}))}return Object(C.jsxs)("div",{className:"flex-container",children:[Object(C.jsx)(Y,{elementRef:x,rawOrderText:n.text,handleClick:g}),Object(C.jsx)(N,{order:j,handleChange:v}),Object(C.jsx)(ee,{elementRef:O,transformDisabled:!n.text,copyDisabled:!s.text,handleOrderTransformFromText:y,handleOrderTransformFromEditor:function(){return o({id:n.id,text:f(j)})}}),Object(C.jsx)(H,{elementRef:O,transformedOrderText:s.text,handleClick:function(e){o(Object(p.a)(Object(p.a)({},s),{},{text:e}))}}),Object(C.jsx)(L,{handleChange:v,order:j}),Object(C.jsx)(M,{order:j,shouldValidate:s.text}),Object(C.jsx)(tt,{order:j,orderId:n.id,transformedOrder:s,handleResetClick:function(){r({text:"",id:null}),o({text:"",id:null}),m(Qe.default())}}),Object(C.jsx)(vt,{handleExport:function(e){g(e),y(e),setTimeout((function(){return x.current.scrollIntoView({smooth:!0})}),700)}})]})}n(282);var yt=n.p+"static/media/paku24-logo.7602fc02.png";function kt(e){var t=e.isLogged;return Object(C.jsx)("div",{className:"logo",children:Object(C.jsxs)("div",{children:[Object(C.jsx)(s.b,{to:t?"/":"/login",children:Object(C.jsx)("img",{src:yt,alt:"Logo",width:"125px"})}),Object(C.jsx)("span",{className:"text",children:"CONFIRMATOR"})]})})}var wt="/api/login";function Ct(){return(Ct=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pe.axiosInstance.post(wt,t).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(){return(Nt=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.axiosInstance.post("".concat(wt,"/token"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Tt={loginWithCredentials:function(e){return Ct.apply(this,arguments)},loginWithAccessToken:function(){return Nt.apply(this,arguments)}},St=n(151),Et=n.n(St),Dt=function(e){var t=e.notification,n="black";return t.toLowerCase().includes("error")&&(n="red"),Object(C.jsx)(C.Fragment,{children:t?Object(C.jsxs)("div",{style:{backgroundColor:"white",color:n,padding:"10px",width:"80%",borderBottom:"3px solid darkgrey",fontSize:"small",display:"flex",alignItems:"center",marginBottom:"10px"},children:[Object(C.jsx)(Et.a,{}),Object(C.jsx)("span",{style:{marginLeft:"10px"},children:t})]}):null})};function zt(e){var t,n=e.setUser,r={marginBottom:"7px",backgroundColor:"white"},c=Object(j.g)(),i=null===c||void 0===c||null===(t=c.location.state)||void 0===t?void 0:t.referrer,o=Object(a.useState)(""),m=Object(u.a)(o,2),h=m[0],p=m[1],b=Object(a.useState)(""),x=Object(u.a)(b,2),O=x[0],v=x[1],g=Object(a.useState)(!1),y=Object(u.a)(g,2),k=y[0],w=y[1],N=Object(a.useState)(!1),T=Object(u.a)(N,2),S=T[0],E=T[1],D=Object(a.useState)(""),z=Object(u.a)(D,2),I=z[0],L=z[1];function F(){return(F=Object(d.a)(l.a.mark((function e(t){var a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),L("Working..."),e.prev=2,e.next=5,Tt.loginWithCredentials({username:h,password:O});case 5:a=e.sent,r=a.user,L("Done"),c.push(i||"/"),n(r),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(2),E(!0),w(!0),setTimeout((function(){return w(!1)}),2e3),L("Error: ".concat(null===(s=e.t0.response)||void 0===s?void 0:s.data.error));case 18:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return Object(C.jsx)("div",{style:{margin:"30px 5px"},children:Object(C.jsxs)("div",{style:{width:"95%",margin:"0 auto",padding:20,backgroundColor:"lightgrey",borderBottom:"4px solid darkgrey"},children:[Object(C.jsxs)("div",{style:{color:"black",fontSize:"1.3rem",letterSpacing:"0.7px",marginTop:"10px",marginBottom:"15px"},children:["LOGIN",Object(C.jsxs)("span",{style:{color:"black",fontSize:"1.0rem",letterSpacing:"0.2px"},children:[" ","or ",Object(C.jsx)(s.b,{to:"/register",children:"request access"})]})]}),Object(C.jsx)(Dt,{notification:I}),Object(C.jsxs)("form",{onSubmit:function(e){return F.apply(this,arguments)},style:{paddingBottom:"10px",height:"80%",display:"flex",flexFlow:"column wrap",justifyContent:"space-evenly"},children:[Object(C.jsx)(f.a,{className:"flex-item",style:r,error:S,required:!0,name:"username",value:h,onChange:function(e){var t=e.target;return p(t.value)},label:"Username",variant:"filled",size:"small"}),Object(C.jsx)(f.a,{className:"flex-item",style:r,error:S,type:"password",required:!0,value:O,name:"password",onChange:function(e){var t=e.target;return v(t.value)},label:"Password",variant:"filled",size:"small"}),Object(C.jsx)(B.a,{className:"flex-item",style:r,type:"submit",disabled:k,variant:"contained",size:"small",children:"Login"})]})]})})}function It(){var e={marginBottom:"7px",backgroundColor:"white"},t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),o=Object(u.a)(i,2),j=o[0],m=o[1],h=Object(a.useState)(""),p=Object(u.a)(h,2),b=p[0],x=p[1],O=Object(a.useState)(""),v=Object(u.a)(O,2),g=v[0],y=v[1],k=Object(a.useState)(!1),w=Object(u.a)(k,2),N=w[0],T=w[1];function S(e){return E.apply(this,arguments)}function E(){return(E=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",de.a.post("/api/registration/request-access",t).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),T(!0),y("Working..."),e.prev=3,e.next=6,S({name:r,email:j,purpose:b});case 6:n=e.sent,y(null===n||void 0===n?void 0:n.message),c(""),m(""),x(""),T(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),T(!1),y("Error: ".concat(null===e.t0||void 0===e.t0||null===(a=e.t0.response.data)||void 0===a?void 0:a.error));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})))).apply(this,arguments)}return Object(C.jsx)("div",{style:{margin:"30px 5px"},children:Object(C.jsxs)("div",{style:{width:"95%",padding:20,margin:"0 auto",backgroundColor:"lightgrey",borderBottom:"4px solid darkgrey"},children:[Object(C.jsxs)("div",{style:{color:"black",fontSize:"1.3rem",letterSpacing:"0.7px",marginTop:"10px",marginBottom:"15px"},children:["REQUEST ACCESS",Object(C.jsxs)("span",{style:{color:"black",fontSize:"1.0rem",letterSpacing:"0.2px"},children:[" ","or ",Object(C.jsx)(s.b,{to:"/login",children:"login"})]})]}),Object(C.jsx)(Dt,{notification:g}),Object(C.jsxs)("form",{onSubmit:function(e){return D.apply(this,arguments)},style:{paddingBottom:"10px",height:"80%",display:"flex",flexFlow:"column wrap",justifyContent:"space-evenly"},children:[Object(C.jsx)(f.a,{style:e,required:!0,name:"name",value:r,onChange:function(e){var t=e.target;return c(t.value)},label:"Name",variant:"filled",size:"small"}),Object(C.jsx)(f.a,{style:e,type:"email",required:!0,value:j,name:"email",onChange:function(e){var t=e.target;return m(t.value)},label:"Email",variant:"filled",size:"small"}),Object(C.jsx)(f.a,{style:e,type:"text",required:!0,multiline:!0,rows:"3",value:b,name:"purpose",onChange:function(e){var t=e.target;return x(t.value)},label:"Why you want to use this application?",variant:"filled",size:"small"}),Object(C.jsx)(B.a,{style:e,type:"submit",disabled:N,variant:"contained",size:"small",children:"Send request"})]})]})})}n(283);var Lt="/api/logout";function Ft(){return(Ft=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",de.a.post(Lt).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pt={logout:function(){return Ft.apply(this,arguments)}},At=n(152),Ut=n.n(At);function Rt(e){var t=e.handleClick;return Object(C.jsxs)(B.a,{style:{backgroundColor:"lightgrey"},variant:"outlined",size:"small",onClick:t,children:["Logout ",Object(C.jsx)(Ut.a,{})]})}function Mt(e){var t=e.user,n=e.logoutUser;return Object(C.jsxs)("div",{style:{backgroundColor:"darkgrey",padding:"15px",marginTop:"40px",display:"flex",justifyContent:"space-between",borderTop:"3.5px solid lightgrey"},children:[Object(C.jsx)("div",{style:{paddingTop:"2px",marginRight:"20px"},children:Object(C.jsxs)("span",{style:{fontFamily:"monospace"},children:[" ",t.username,Object(C.jsx)("br",{}),t.name]})}),Object(C.jsx)(Rt,{handleClick:function(){return Pt.logout().then(n)}})]})}function Wt(e){var t=e.error;return Object(C.jsxs)("div",{role:"alert",children:[Object(C.jsx)("p",{children:"Something went wrong:"}),Object(C.jsx)("pre",{style:{color:"red"},children:t.message})]})}function Bt(e){var t,n=e.user,a=e.setUser,r=e.children,c=Object(j.g)();null!==n&&"Loading"!==n||(t=c.location.pathname);var i="Loading"===n,s=null===n&&Object(C.jsx)(j.a,{to:{pathname:"/login",state:{referrer:t}}});return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(pt,{loading:i,redirectComponent:s,children:r}),Object(C.jsx)(j.b,{path:"/login",children:null===n?Object(C.jsx)(zt,{setUser:a}):Object(C.jsx)(j.a,{to:"/"})})]})}var qt=function(){var e=Object(a.useState)("Loading"),t=Object(u.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){pe.setupInterceptor({logout:function(){return r(null)}})}),[]),Object(a.useEffect)(Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Tt.loginWithAccessToken();case 3:return t=e.sent,n=t.user,e.abrupt("return",r(n));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",r(null));case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),[]),Object(C.jsx)("div",{className:"container",children:Object(C.jsxs)(m.ErrorBoundary,{FallbackComponent:Wt,children:[Object(C.jsx)(kt,{isLogged:null!==n&&"Loading"!==n}),Object(C.jsxs)(j.d,{children:[Object(C.jsx)(j.b,{path:"/register",children:Object(C.jsx)(It,{})}),Object(C.jsx)(j.b,{path:"/",children:Object(C.jsxs)(Bt,{user:n,setUser:r,children:[Object(C.jsx)(gt,{}),Object(C.jsx)(Mt,{user:n,logoutUser:function(){return r(null)}})]})})]})]})})};n(284);i.a.render(Object(C.jsx)(r.a.StrictMode,{children:Object(C.jsx)(s.a,{basename:"/app",children:Object(C.jsx)(qt,{})})}),document.getElementById("root"))},53:function(e){e.exports=JSON.parse('[{"id":1,"name":"Pakettiauto ja kuljettaja","price":30,"priceXL":40},{"id":2,"name":"Pakettiauto ja muuttomies","price":60,"priceXL":60},{"id":3,"name":"Pakettiauto ja kaksi muuttomiest\xe4","price":90,"priceXL":90},{"id":4,"name":"Nouto/tyhjennyspalvelu yhdell\xe4 kantajalla","price":40,"priceXL":40},{"id":5,"name":"Nouto/tyhjennyspalvelu kahdella kantajalla","price":70,"priceXL":70}]')},58:function(e){e.exports=JSON.parse('[{"id":1,"name":"Maksukortti"},{"id":2,"name":"K\xe4teinen"},{"id":3,"name":"Lasku/Osamaksu"},{"id":4,"name":"Bank card"},{"id":5,"name":"Cash"},{"id":6,"name":"Invoice/Instalment payment"}]')},65:function(e){e.exports=JSON.parse('{"morning":{"name":"Aamulis\xe4","amount":20},"night":{"name":"Y\xf6lis\xe4","amount":20},"holiday":{"name":"Pyh\xe4lis\xe4","amount":15},"weekend":{"name":"Viikonloppulis\xe4","amount":15},"firstOrLastDayOfTheMonth":{"name":"Kuunvaihdelis\xe4","amount":15},"bill":{"name":"Laskulis\xe4","amount":14}}')}},[[285,1,2]]]);
//# sourceMappingURL=main.924ca276.chunk.js.map