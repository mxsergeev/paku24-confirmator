(this["webpackJsonppaku24-confirmator-front"]=this["webpackJsonppaku24-confirmator-front"]||[]).push([[0],{156:function(e){e.exports=JSON.parse('{"insideCapital":"insideCapital","outsideCapital":"outsideCapital","fromCapitalToOutside":"fromCapitalToOutside","fromOutsideToCapital":"fromOutsideToCapital"}')},192:function(e,t,n){},195:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){},296:function(e,t,n){},297:function(e,t,n){},298:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){},301:function(e,t,n){},302:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(15),i=n.n(c),s=n(36),o=n(32),l=n(168),d=n.n(l),u=n(8),j=n.n(u),m=n(12),p=n(11),b=n(10),h=n(54),f=n(20),x=n(167),O=n(354),v=(n(192),n(1));function g(){var e=Object(f.g)();function t(t){e.push(t.currentTarget.name)}return Object(v.jsxs)("div",{className:"hub",children:[Object(v.jsx)(O.a,{onClick:t,name:"confirmator",variant:"contained",className:"hub-block",children:"Confirmator"}),Object(v.jsx)(O.a,{onClick:t,name:"statistics",variant:"contained",className:"hub-block",children:"Statistics"})]})}var y=n(44),k=(n(195),n(370)),w=n(148),C=n(307),S=n(144),N=n(103),T=n.n(N),E=n(21),D=n(369),I=n(59),z=n(66);function L(e){var t=e.order,n=e.handleChange,a={marginTop:5},c={marginLeft:5,marginRight:5},i=Object(r.useState)(t.dateTime),s=Object(p.a)(i,2),o=s[0],l=s[1];return Object(r.useEffect)((function(){n({target:{name:"dateTime",value:o}})}),[o]),T.a.weekStart=1,Object(v.jsxs)("div",{className:"basic-flex",style:{marginTop:"5px"},children:[Object(v.jsxs)("div",{className:"flex-100-space-between flex-item",style:c,children:[Object(v.jsx)(E.a,{utils:S.a,locale:T.a,children:Object(v.jsx)(D.a,{ampm:!1,format:"DD-MM-YYYY HH:mm",minutesStep:15,style:c,className:"time-duration",name:"dateTime",value:t.dateTime,onChange:l,DialogProps:{disableScrollLock:!0}})}),Object(v.jsxs)(w.a,{className:"time-duration",style:Object(b.a)(Object(b.a)({},c),{},{paddingLeft:10}),name:"duration",value:null===t||void 0===t?void 0:t.duration,onChange:n,children:[Object(v.jsx)("option",{value:1,children:"1h"}),Object(v.jsx)("option",{value:1.5,children:"1.5h"}),Object(v.jsx)("option",{value:2,children:"2h"}),Object(v.jsx)("option",{value:2.5,children:"2.5h"}),Object(v.jsx)("option",{value:3,children:"3h"}),Object(v.jsx)("option",{value:3.5,children:"3.5h"}),Object(v.jsx)("option",{value:4,children:"4h"}),Object(v.jsx)("option",{value:4.5,children:"4.5h"}),Object(v.jsx)("option",{value:5,children:"5h"}),Object(v.jsx)("option",{value:5.5,children:"5.5h"}),Object(v.jsx)("option",{value:6,children:"6h"}),Object(v.jsx)("option",{value:6.5,children:"6.5h"}),Object(v.jsx)("option",{value:7,children:"7h"}),Object(v.jsx)("option",{value:7.5,children:"7.5h"}),Object(v.jsx)("option",{value:8,children:"8h"}),Object(v.jsx)("option",{value:8.5,children:"8.5h"}),Object(v.jsx)("option",{value:9,children:"9h"}),Object(v.jsx)("option",{value:9.5,children:"9.5h"}),Object(v.jsx)("option",{value:10,children:"10h"})]})]}),Object(v.jsx)(w.a,{fullWidth:!0,style:c,className:"flex-item",name:"serviceName",value:null===t||void 0===t?void 0:t.serviceName,onChange:n,children:I.map((function(e){return Object(v.jsx)("option",{value:e.name,children:e.name},e.id)}))}),Object(v.jsx)(w.a,{fullWidth:!0,style:c,className:"flex-item",name:"paymentType",value:null===t||void 0===t?void 0:t.paymentType,onChange:n,children:z.map((function(e){var t=e.name,n=e.id;return Object(v.jsx)("option",{value:t,children:t},n)}))}),Object(v.jsx)(k.a,{fullWidth:!0,style:a,className:"flex-item",required:!0,name:"address",value:null===t||void 0===t?void 0:t.address,onChange:n,label:"Address",variant:"outlined",size:"small"}),Object(v.jsx)(k.a,{fullWidth:!0,multiline:!0,style:a,className:"flex-item",name:"destination",value:null===t||void 0===t?void 0:t.destination,onChange:n,label:"Destination",variant:"outlined",size:"small"}),Object(v.jsx)(k.a,{fullWidth:!0,required:!0,style:a,className:"flex-item",name:"name",value:null===t||void 0===t?void 0:t.name,onChange:n,label:"Name",variant:"outlined",size:"small"}),Object(v.jsx)(k.a,{fullWidth:!0,style:a,className:"flex-item",name:"email",value:null===t||void 0===t?void 0:t.email,onChange:n,type:"email",label:"Email",variant:"outlined",size:"small"}),Object(v.jsx)(k.a,{fullWidth:!0,style:a,className:"flex-item",required:!0,name:"phone",value:null===t||void 0===t?void 0:t.phone,onChange:n,label:"Phonenumber",variant:"outlined",size:"small"}),Object(v.jsx)(C.a,{style:a,className:"flex-item textarea-2",rowsMin:3,cols:27,name:"comment",value:null===t||void 0===t?void 0:t.comment,placeholder:"Additional information.",onChange:n})]})}var F=n(357),P=n(356),A=n(360),U=n(373),W=n(372),M=n(378);function R(e){var t=e.handleChange,n=e.order;return Object(v.jsxs)("div",{className:"checkbox-container",children:[Object(v.jsxs)(P.a,{className:"checkbox-distance flex-item",hiddenLabel:!1,size:"small",children:[Object(v.jsx)(F.a,{component:"legend",children:"Pick one:"}),Object(v.jsxs)(M.a,{value:n.distance,onChange:t,children:[Object(v.jsx)(A.a,{name:"distance",value:"insideCapital",control:Object(v.jsx)(W.a,{color:"default"}),label:"\ud83c\udfd9 Inside capital"}),Object(v.jsx)(A.a,{name:"distance",value:"outsideCapital",control:Object(v.jsx)(W.a,{color:"default"}),label:"\ud83c\udfde Outside capital"}),Object(v.jsx)(A.a,{name:"distance",value:"fromCapitalToOutside",control:Object(v.jsx)(W.a,{color:"default"}),label:"\ud83c\udfd9->\ud83c\udfde From capital"}),Object(v.jsx)(A.a,{name:"distance",value:"fromOutsideToCapital",control:Object(v.jsx)(W.a,{color:"default"}),label:"\ud83c\udfde->\ud83c\udfd9 To capital"})]})]}),Object(v.jsxs)(P.a,{className:"basic-flex",size:"small",children:[Object(v.jsx)(A.a,{size:"small",className:"flex-item",control:Object(v.jsx)(U.a,{checked:n.hsy,onChange:t,color:"primary"}),name:"hsy",label:"\u267b HSY",labelPlacement:"start"}),Object(v.jsx)(A.a,{className:"flex-item",control:Object(v.jsx)(U.a,{checked:n.altColorPalette,onChange:t,color:"primary"}),name:"altColorPalette",label:"Second car",labelPlacement:"start"}),Object(v.jsx)(A.a,{className:"flex-item",control:Object(v.jsx)(U.a,{checked:n.XL,onChange:t,color:"primary"}),name:"XL",label:"XL",labelPlacement:"start"})]})]})}var B=n(76),q=n.n(B),Y=n(149),J=n.n(Y);function X(e){var t=e.validationArray,n={color:"red"};return Object(v.jsx)(v.Fragment,{children:t.map((function(e){return e.isError?Object(v.jsxs)("div",{children:[Object(v.jsxs)("span",{style:n,children:[e.name," "]}),e.message]},e.id):null}))})}function H(e){var t=e.order,n=e.shouldValidate,a=Object(r.useState)([]),c=Object(p.a)(a,2),i=c[0],s=c[1];Object(r.useEffect)((function(){if(n){var e=[{id:1,name:"Date and time",isError:q.a.isBefore(t.dateTime.toISOString(),(new Date).toISOString()),message:"might have some problems. Check to be sure: ".concat("".concat(t.confirmationDateString," ").concat(t.time)||"---")},{id:2,name:"Address",isError:q.a.isEmpty(t.address),message:"is missing"},{id:3,name:"Phonenumber",isError:!q.a.isMobilePhone(t.phone,["fi-FI","es-ES","sv-SE"]),message:"is missing or is incorrect: ".concat(t.phone||"---")},{id:4,name:"Email",isError:!q.a.isEmail(t.email),message:"is missing or is incorrect: ".concat(t.email||"---")}];s(e)}}),[t.dateTime,t.phone,t.address,t.email,n]);var o=i.some((function(e){return e.isError}));return Object(v.jsx)(v.Fragment,{children:n&&o&&Object(v.jsx)("div",{style:{borderTop:"1px solid gray",borderBottom:"1px solid gray",padding:"15px 0 15px 0",margin:"10px 0 10px 0"},className:"flex-100-space-between",children:Object(v.jsxs)("div",{children:[Object(v.jsx)(J.a,{}),Object(v.jsx)(X,{validationArray:i})]})})})}var K=n(309),V=n(150),_=n.n(V),$=(n(276),function(e,t){return function(n){var a=n.content,c=n.handleUpdate,i=Object(h.a)(n,["content","handleUpdate"]),s=Object(r.useState)(!1),o=Object(p.a)(s,2),l=o[0],d=o[1],u=Object(r.useState)(a),j=Object(p.a)(u,2),m=j[0],f=j[1],x=Object(r.useState)(m),g=Object(p.a)(x,2),y=g[0],k=g[1];function w(e){k(e.target.value)}function C(){k(m),d(!l)}function S(){f(y),c(y),d(!l)}function N(){d(!l)}return Object(v.jsx)(v.Fragment,{children:l?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(e,Object(b.a)({content:y,handleChange:w},i)),Object(v.jsxs)("div",{className:"buttons-block",children:[Object(v.jsx)(O.a,{size:"small",onClick:C,children:"Cancel"}),Object(v.jsx)(O.a,{className:"primary",size:"small",onClick:S,children:"Save"})]})]}):Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(t,Object(b.a)({content:a,button:Object(v.jsx)("span",{children:Object(v.jsx)(K.a,{size:"small",onClick:N,children:Object(v.jsx)(_.a,{style:{width:"20px"}})})})},i))})})}});function G(e){var t=e.handleClick,n=e.rawOrderText,r=e.elementRef,a=$((function(e){var t=e.handleChange,n=e.content;return Object(v.jsx)(C.a,{onChange:t,value:n,style:{marginTop:"10px"},className:"width-100",rowsMin:5,cols:40,placeholder:"Raw order here."})}),(function(e){var t=e.button;return Object(v.jsxs)("div",{ref:r,className:"not-editable-container",children:["Raw order",t]})}));return Object(v.jsx)(a,{style:{width:"max-content"},handleUpdate:t,content:n})}n(277);function Q(e){var t=e.elementRef,n=e.handleClick,r=e.transformedOrderText,a=$((function(e){var n=e.handleChange,r=e.content;return Object(v.jsx)(C.a,{onChange:n,value:r,ref:t,style:{marginTop:"10px"},className:"width-100",rowsMin:5,cols:40,placeholder:"Transformed order."})}),(function(e){var n=e.content,a=e.button;return Object(v.jsxs)("div",{ref:t,style:{width:r&&"100%",marginTop:"12px"},className:"not-editable-container",children:[0===n.length?"Transformed order":Object(v.jsx)("div",{className:"text-container-with-scroll",children:n.split("\n").map((function(e,t){return Object(v.jsx)("div",{children:e},t)}))}),a]})}));return Object(v.jsx)(a,{handleUpdate:n,content:r})}var Z=n(151),ee=n.n(Z);function te(e){var t=e.handleClick,n=e.text,r=void 0===n?"Transform":n,a=Object(h.a)(e,["handleClick","text"]);return Object(v.jsxs)(O.a,Object(b.a)(Object(b.a)({className:"button-one-third flex-item",variant:"outlined",size:"small",style:{fontSize:"0.8rem",padding:"1px"},onClick:function(){return t()}},a),{},{children:[Object(v.jsx)(ee.a,{}),r]}))}var ne=n(152),re=n.n(ne);function ae(e){var t=e.elementRef,n=e.disabled,r=Object(o.b)().enqueueSnackbar;return Object(v.jsxs)(O.a,{disabled:n,className:"button-one-third flex-item",variant:"outlined",size:"small",onClick:function(){!function(){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t.current.innerText||t.current.defaultValue,e.select(),document.execCommand("copy"),document.body.removeChild(e)}(),r("Copied!",{autoHideDuration:750})},children:["Copy ",Object(v.jsx)(re.a,{})]})}function ce(e){var t=e.handleOrderTransformFromText,n=e.handleOrderTransformFromEditor,r=e.transformDisabled,a=e.copyDisabled,c=e.elementRef;return Object(v.jsx)("div",{className:"order-operations",children:Object(v.jsxs)("div",{className:"block",children:[Object(v.jsx)(ae,{disabled:a,elementRef:c}),Object(v.jsx)(te,{text:"from text",disabled:r,handleClick:t}),Object(v.jsx)(te,{text:"from editor",handleClick:n})]})})}var ie=n(153),se=n.n(ie);function oe(e){var t=e.handleClick,n=e.className;return Object(v.jsxs)(O.a,{className:n,variant:"contained",size:"small",onClick:t,children:["New order ",Object(v.jsx)(se.a,{})]})}function le(e){var t=e.className,n=e.orderPoolUrl,r=Object(f.g)();return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(O.a,{size:"small",className:t,variant:"contained",onClick:function(){r.push(n)},children:"Order Pool"})})}function de(e){var t=e.text,n=e.className,r=Object(h.a)(e,["text","className"]);return Object(v.jsx)("div",Object(b.a)(Object(b.a)({className:"message ".concat(n)},r),{},{children:t}))}var ue=n(154),je=n.n(ue);function me(e){var t=e.handleClick,n=e.isDisabled,r=e.grayScale,a=e.content,c=e.className,i=r&&{color:"grey"};return Object(v.jsx)(O.a,{disabled:n,className:c,variant:"contained",size:"small",onClick:t,children:Object(v.jsx)("span",{style:Object(b.a)({display:"flex"},i),children:a})})}var pe=n(48),be=n.n(pe),he="/api/token";function fe(){return(fe=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.axiosInstance.post(he);case 2:return e.next=4,ve.axiosInstance.post("".concat(he,"/is-new"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe={refreshTokens:function(){return fe.apply(this,arguments)}},Oe=be.a.create();var ve={axiosInstance:Oe,setupInterceptor:function(e){Oe.interceptors.response.use((function(e){return e}),function(){var t=Object(m.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.config,"access token expired"!==n.response.data.error){t.next=5;break}return t.next=4,xe.refreshTokens();case 4:return t.abrupt("return",Oe(r));case 5:if("access token missing"!==n.response.data.error&&"invalid access token"!==n.response.data.error&&"refresh token expired"!==n.response.data.error&&"invalid refresh token"!==n.response.data.error&&"refresh token missing"!==n.response.data.error){t.next=9;break}throw e.notificate(),e.logout(),new Error("logout");case 9:return 429===n.response.status&&setTimeout((function(){return null}),1500),t.abrupt("return",Promise.reject(n));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},ge="/api/email";function ye(){return(ye=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.axiosInstance.post("".concat(ge,"/send-confirmation"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke="email";function we(e){var t=e.email,n=e.order,r=e.transformedOrderText,a=e.statusText,c=e.isDisabled,i=e.changeStatus,s=e.className,l=Object(o.b)().enqueueSnackbar;var d=a||Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("span",{children:"Send"})," ",Object(v.jsx)(je.a,{})]});return Object(v.jsx)(me,{className:s,isDisabled:c,grayScale:null!==a,handleClick:function(){return t&&r?(i(ke,"Working",!0),function(e){return ye.apply(this,arguments)}({orderDetails:r,order:n,email:t}).then((function(e){i(ke,"Done",!0),l(e.message)})).catch((function(e){"logout"!==e.message&&(i(ke,"Error",!1),l(e.response.data.error,{variant:"error"}))}))):l("No confirmation found or recipients defined.",{variant:"warning"})},content:d})}var Ce=n(155),Se=n.n(Ce),Ne="/api/sms";function Te(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.axiosInstance.post(Ne,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De="sms";function Ie(e){var t=e.phone,n=e.transformedOrderText,r=e.statusText,a=e.isDisabled,c=e.changeStatus,i=e.className,s=Object(o.b)().enqueueSnackbar;function l(){return(l=Object(m.a)(j.a.mark((function e(){var r,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=n)||!t){e.next=9;break}return c(De,"Working",!0),e.next=6,Te({msg:r,phone:t});case 6:a=e.sent,c(De,"Done",!0),s("".concat(a.message));case 9:e.next=17;break;case 11:if(e.prev=11,e.t0=e.catch(0),"logout"!==e.t0.message){e.next=15;break}return e.abrupt("return");case 15:c(De,"Error",!1),s(null===(i=e.t0.response)||void 0===i?void 0:i.data.error,{variant:"error"});case 17:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var d=r||Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("span",{children:"Send"})," ",Object(v.jsx)(Se.a,{})]});return Object(v.jsx)(me,{className:i,isDisabled:a,grayScale:null!==r,handleClick:function(){return l.apply(this,arguments)},content:d})}var ze=n(157),Le=n.n(ze),Fe="/api/calendar";function Pe(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.axiosInstance.post(Fe,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ue="/api/order-pool";function We(e,t){return t.map((function(n,r){var a=r===t.length-1;return"".concat(e,"[]=").concat(n).concat(a?"":"&")})).join("")}function Me(e){var t=e.query,n=e.orders;return new Promise((function(e){return e(sessionStorage.setItem("order-pool/".concat(t),JSON.stringify({validUntil:Date.now()+3e5,orders:n})))}))}function Re(e){return Promise.resolve().then((function(){return JSON.parse(sessionStorage.getItem("order-pool/".concat(e)))}))}function Be(e){return Promise.resolve(function(){try{return JSON.parse(sessionStorage.getItem("order-pool/".concat(e))).validUntil>Date.now()}catch(t){return!1}}())}function qe(){return(qe=Object(m.a)(j.a.mark((function e(){var t,n,r,a,c,i,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:[1],n=s.length>1&&void 0!==s[1]?s[1]:{deleted:!1,forceUpdate:!1},r=n.deleted,a=n.forceUpdate,c="".concat(r?"deleted=true":"deleted=false","&").concat(We("pages",t)),e.t0=!a,!e.t0){e.next=9;break}return e.next=8,Be(c);case 8:e.t0=e.sent;case 9:if(!e.t0){e.next=11;break}return e.abrupt("return",Re(c).then((function(e){return e.orders})));case 11:return i="".concat(Ue,"/?").concat(c),e.abrupt("return",ve.axiosInstance.get(i).then(function(){var e=Object(m.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null===t||void 0===t?void 0:t.data,r=n.orders,e.next=3,Me({query:c,orders:r});case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(){return(Ye=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.axiosInstance.delete("".concat(Ue,"/delete/").concat(t));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(){return(Je=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.axiosInstance.put("".concat(Ue,"/retrieve/").concat(t));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Xe={get:function(){return qe.apply(this,arguments)},confirm:function(e){return ve.axiosInstance.put("".concat(Ue,"/confirm/").concat(e)).then((function(e){return null===e||void 0===e?void 0:e.data}))},remove:function(e){return Ye.apply(this,arguments)},retrieve:function(e){return Je.apply(this,arguments)},getConfirmedOrders:function(e){var t=e.periodFrom,n=e.periodTo;return ve.axiosInstance.get("".concat(Ue,"/confirmed-by-user/?periodFrom=").concat(t,"&periodTo=").concat(n)).then((function(e){return e.data}))},add:function(e){var t=e.order,n=e.key;return ve.axiosInstance.post("".concat(Ue,"/add"),{order:t,key:n}).then((function(e){return null===e||void 0===e?void 0:e.data}))}},He=n(104),Ke=n(89),Ve=n(90),_e=n(92),$e=n(71);function Ge(e){return"Cannot find ".concat(e)}var Qe=function(){function e(t){Object(Ke.a)(this,e),this.textOrder=e.initialCleanup(t)}return Object(Ve.a)(e,[{key:"dateTime",get:function(){var e=/(?<=Date and time: \w+, )\w+ \d+(th|rd|st|nd)? \w+/.exec(this.textOrder);if(!e)throw new Error(Ge("date"));var t=new Date("".concat(e[0].replace(/(?<=\d+)(th|rd|st|nd)/,""),"Z")),n=/\d+:\d+/.exec(this.textOrder)[0];return new Date("\n    ".concat(t.getFullYear(),"\n    ").concat(t.getMonth()+1,"\n    ").concat(t.getDate(),"\n    ").concat(n))}},{key:"duration",get:function(){var e=/\d+(\.\d+)?(?=\sh.)/.exec(this.textOrder);if(!e)throw new Error(Ge("duration"));return e[0]}},{key:"paymentType",get:function(){var e="Payment Type: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("PRICE"),r=this.textOrder.slice(t,n).trim(),a=r.match(/\W+/g).filter((function(e){return"/"!==e&&" "!==e&&"\xe4"!==e})),c=r.indexOf(a[0].trim()),i=r.slice(0,c).trim();if(!i)throw new Error(Ge("payment type"));if(!z.map((function(e){return e.name})).includes(i))throw new Error("Unrecognized payment type");return i}},{key:"movingBoxesPrice",get:function(){var e=this.textOrder.indexOf("\u2014 Price: "),t=this.textOrder.indexOf("\u2014 Booking time start"),n=this.textOrder.slice(e,t);return n&&n.match(/\d+/)[0]}},{key:"serviceName",get:function(){var e="Service: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("Accessories"),r=this.textOrder.slice(t,n).trim();if(!r)throw new Error(Ge("service name"));if(!I.find((function(e){return e.name===r})))throw new Error("Unrecognized service name");return r}},{key:"addresses",get:function(){var e=this,t=["End location","Name"],n=[];return["Start location:","End location:"].forEach((function(r,a){var c=e.textOrder.indexOf(r)+r.length,i=e.textOrder.indexOf(t[a]),s=e.textOrder.slice(c,i).replaceAll(",","").trim(),o=s.slice(0,s.indexOf(" / ")),l=s.match(/\d{5}/);l=l&&l[0]||"";var d=s.slice(s.indexOf(" / ")+" / ".length),u=o.match(/\D+/);u=u&&u[0];var j=d.replace(l,"");if(j=j||null,(!/\d+/.test(d)||d.includes(l)&&d.length<15)&&(j=o.replace(l,""),u=(u=d.match(/\D+/))&&u[0]),j.includes(u)&&(j=j.replace(u,"")),0===a&&!j)throw new Error(Ge("address"));n.push("".concat(j,", ").concat(l," ").concat(u).replace(/\s+/g," ").trim())})),n}},{key:"address",get:function(){return this.addresses[0]}},{key:"destination",get:function(){return Object(p.a)(this.addresses,2)[1]}},{key:"name",get:function(){var e="Name: ",t=this.textOrder.indexOf(e)+e.length,n=this.textOrder.indexOf("Email"),r=this.textOrder.slice(t,n).trim();if(!r)throw new Error(Ge("name"));return r}},{key:"email",get:function(){var e=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.exec(this.textOrder);if(!e)throw new Error(Ge("email"));return e[0]}},{key:"phone",get:function(){var e=/(?<=Phone: )[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\s\./0-9]*/.exec(this.textOrder);if(!e)throw new Error(Ge("phone"));return e[0].trim()}},{key:"comment",get:function(){var e=/(?<=Comment: )(.*\s*)*/.exec(this.textOrder);e=e?e[0]:"";var t=/\n\n\-\-\nT\xe4m\xe4 viesti l\xe4hetettiin sivustolta Paku24\.fi \(https:\/\/paku24\.fi\)/;return t.exec(e)&&(e=e.replace(t,"")),e}}],[{key:"initialCleanup",value:function(e){var t=e.split("\n"),n=[];return t.forEach((function(e){return n.push(e.trim())})),n.join("\n").replaceAll("\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014","").replaceAll("------------------------","")}}]),e}(),Ze=n(156),et={dateTime:new Date,duration:1,serviceName:I[0].name,paymentType:z[0].name,address:"",destination:"",name:"",email:"",phone:"",comment:"",distance:Ze.insideCapital,hsy:!1,altColorPalette:!1,XL:!1},tt=Object.keys(et),nt=function(){function e(t){Object(Ke.a)(this,e);var n,r=Object(He.a)(tt);try{for(r.s();!(n=r.n()).done;){var a,c=n.value;this[c]=null!==(a=t[c])&&void 0!==a?a:et[c]}}catch(i){r.e(i)}finally{r.f()}this.dateTime=new Date(t.dateTime)}return Object(Ve.a)(e,[{key:"time",get:function(){return this.dateTime.toTimeString().slice(0,5)}},{key:"servicePrice",get:function(){var e=this,t=I.find((function(t){return t.name===e.serviceName}));return this.XL?t.priceXL:t.price}},{key:"ISODateString",get:function(){return"".concat(this.dateTime.toISOString().split("T")[0],"T").concat(this.time)}},{key:"confirmationDateString",get:function(){var e=this.dateTime.getDate(),t=this.dateTime.getMonth()+1,n=this.dateTime.getFullYear();return e<10&&(e="0".concat(e)),t<10&&(t="0".concat(t)),"".concat(e,"-").concat(t,"-").concat(n)}},{key:"fees",get:function(){var e=1*this.time.split(":")[0],t=this.dateTime.getDay(),n=this.dateTime.getDate(),r=[new Date(this.dateTime.getFullYear(),this.dateTime.getMonth()+1,0).getDate(),1],a=6===t||0===t,c=!a&&r.includes(n),i=e<8,s=e>=20,o="Lasku"===this.paymentType||"Lasku/Osamaksu"===this.paymentType||"Invoice/Instalment payment"===this.paymentType;return[a&&$e.weekend,c&&$e.firstOrLastDayOfTheMonth,i&&$e.morning,s&&$e.night,o&&$e.bill].filter((function(e){return!1!==e}))}},{key:"printFees",value:function(){var e="\n@feeName\n@feeAmount".repeat(this.fees.length);return this.fees.forEach((function(t){e=(e=e.replace("@feeName",t.name.toUpperCase())).replace("@feeAmount","".concat(t.amount,"\u20ac"))})),e}},{key:"prepareForSending",value:function(){var e=this;return delete e.hsy,delete e.altColorPalette,delete e.distance,JSON.stringify(e)}}],[{key:"getEventForCalendar",value:function(e,t){return e.slice(e.indexOf(t))}},{key:"setupOrderFromText",value:function(t){return new Promise((function(n){Object(_e.a)(t)&&n(new e(JSON.parse(t)));var r,a={},c=new Qe(t),i=Object(He.a)(tt);try{for(i.s();!(r=i.n()).done;){var s=r.value;a[s]=c[s]}}catch(o){i.e(o)}finally{i.f()}n(new e(a))}))}},{key:"default",value:function(){return new e(et)}},{key:"transformToText",value:function(e,t){var n;try{n="VARAUKSEN TIEDOT\n".concat(e.confirmationDateString,"\nALKAMISAIKA\nKlo ").concat(e.time," (+/-15min)\nARVIOITU KESTO\n").concat(e.duration,"h (").concat(e.servicePrice,"\u20ac/h, ").concat(e.serviceName,")\nMAKSUTAPA\n").concat(e.paymentType).concat(e.printFees(),"\nL\xc4HT\xd6PAIKKA\n").concat(e.address,"\n").concat(e.destination.length>5?"M\xc4\xc4R\xc4NP\xc4\xc4\n".concat(e.destination,"\n"):"","NIMI\n").concat(e.name,"\n").concat(e.email?"S\xc4HK\xd6POSTI\n".concat(e.email,"\n"):"","PUHELIN\n").concat(e.phone,"\n").concat(e.comment?"LIS\xc4TIETOJA\n".concat(e.comment,"\n"):""),t("Succesefully formatted!")}catch(r){console.error(r),t(r.message)}return n}}]),e}(),rt="calendar";function at(e){var t=e.order,n=e.orderId,r=e.transformedOrderText,a=e.statusText,c=e.isDisabled,i=e.changeStatus,s=e.className,l=Object(o.b)().enqueueSnackbar;function d(){return(d=Object(m.a)(j.a.mark((function e(){var a,c,s,o,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(a=nt.getEventForCalendar(r,t.address))){e.next=17;break}return i(rt,"Working",!0),e.next=6,Pe({entry:a,order:t,fees:t.fees});case 6:if(c=e.sent,n){e.next=13;break}return e.next=10,Xe.add({order:t.prepareForSending(),key:"supersecretorderpoolkey"});case 10:s=e.sent,o=s.id,n=o;case 13:return e.next=15,Xe.confirm(n);case 15:i(rt,"Done",!0),l("".concat(c.message,"\n").concat(c.createdEvent));case 17:e.next=25;break;case 19:if(e.prev=19,e.t0=e.catch(0),"logout"!==e.t0.message){e.next=23;break}return e.abrupt("return");case 23:i(rt,"Error",!1),l(null===(d=e.t0.response)||void 0===d?void 0:d.data.error,{variant:"error"});case 25:case"end":return e.stop()}}),e,null,[[0,19]])})))).apply(this,arguments)}var u=a||Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("span",{children:"Add"})," ",Object(v.jsx)(Le.a,{})]});return Object(v.jsx)(me,{className:s,isDisabled:c,grayScale:null!==a,handleClick:function(){return d.apply(this,arguments)},content:u})}n(296);function ct(e){var t=e.order,n=e.orderId,a=e.transformedOrder,c=e.handleResetClick,i=e.orderPoolUrl,s={email:{status:null,disable:!1},sms:{status:null,disable:!1},calendar:{status:null,disable:!1}},o=Object(r.useState)(s),l=Object(p.a)(o,2),d=l[0],u=l[1];function j(e,t,n){u(Object(b.a)(Object(b.a)({},d),{},Object(y.a)({},e,{status:t,disable:n})))}return Object(v.jsxs)("div",{className:"order-operations",children:[function(){var e=d.email.disable||!(t.email&&a.text);return Object(v.jsxs)("div",{className:"block",children:[Object(v.jsx)(de,{className:"width-75 ".concat(e&&"grayedFont"),text:"Email to: ".concat(t.email)}),Object(v.jsx)(we,{className:"width-25",email:t.email,order:t,statusText:d.email.status,isDisabled:e,transformedOrderText:a.text,changeStatus:j})]})}(),function(){var e=d.sms.disable||!(t.phone&&a.text);return Object(v.jsxs)("div",{className:"block",children:[Object(v.jsx)(de,{className:"width-75 ".concat(e&&"grayedFont"),text:"Sms to: ".concat(t.phone)}),Object(v.jsx)(Ie,{className:"width-25",statusText:d.sms.status,isDisabled:e,phone:t.phone,transformedOrderText:a.text,changeStatus:j})]})}(),function(){var e=d.calendar.disable||!a.text;return Object(v.jsxs)("div",{className:"block",children:[Object(v.jsx)(oe,{className:"share-space",handleClick:function(){u(s),c()}}),Object(v.jsx)(le,{className:"share-space",orderPoolUrl:i}),Object(v.jsx)(at,{className:"width-25",statusText:d.calendar.status,isDisabled:e,order:t,orderId:n,transformedOrderText:a.text,changeStatus:j})]})}()]})}var it=n(374),st=n(359),ot=n(358),lt=n(361),dt=n(31);function ut(e){var t=e.children,n=e.handleClose,r=Object(dt.a)(),a=Object(lt.a)(r.breakpoints.down("sm"));return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(it.a,{fullScreen:a,open:!0,onClose:n,"aria-labelledby":"responsive-dialog-title",disableScrollLock:!0,children:[Object(v.jsx)(ot.a,{children:t}),Object(v.jsx)(st.a,{children:Object(v.jsx)(O.a,{style:{backgroundColor:"white"},variant:"text",onClick:n,children:"Close"})})]})})}var jt=n(61),mt=n(158),pt=n.n(mt),bt=n(160),ht=n.n(bt),ft=n(159),xt=n.n(ft);function Ot(e){var t=e.loading,n=e.redirectComponent,r=void 0===n?null:n,a=e.children;return Object(v.jsxs)(v.Fragment,{children:[t&&Object(v.jsx)("p",{children:"Loading..."}),r,!t&&!r&&a]})}function vt(e){var t=e.orders,n=e.handleExport,a=e.handleDeletion,c=e.handleLoadingMoreOrders,i=e.labelForDeletion,s=Object(r.useState)([]),o=Object(p.a)(s,2),l=o[0],d=o[1];function u(e,t){return e.split("\n").map((function(e,n){return Object(v.jsx)("div",{children:e},"".concat(t).concat(n).concat(e))}))}return Object(r.useEffect)((function(){d(t.map((function(e){return{order:Object(b.a)({},e),isNew:new Date(e.date).toDateString()===new Date(Date.now()).toDateString(),className:e.confirmed?"basic-order-style confirmed-order-style":"basic-order-style",hidden:e.confirmed}})))}),[t]),0===t.length?Object(v.jsx)("p",{children:"Nothing found"}):Object(v.jsxs)(v.Fragment,{children:[l.map((function(e){return Object(v.jsxs)("div",{className:"order-pool-list",children:[Object(v.jsxs)("div",{className:"order-top-bar",children:[Object(v.jsxs)("div",{className:"order-status-icons-container",children:[e.isNew&&Object(v.jsx)("span",{className:"order-status-new-order order-status-icon",children:"NEW"}),Object(v.jsxs)("span",{className:"order-status-icon ".concat(e.order.confirmed?"order-status-icon order-status-confirmed":"order-status-icon order-status-notification"),children:[e.order.confirmed?"\u2714":"\u2755"," "]})]}),Object(v.jsxs)("div",{className:"order-actions",children:[Object(v.jsx)(O.a,{style:{padding:0,fontSize:"0.9rem"},variant:"text",size:"small",onClick:function(){return a(e.order.id)},children:i}),Object(v.jsx)(O.a,{style:{padding:0,fontSize:"0.8rem",color:e.order.confirmed&&"var(--brand-color-dark)"},onClick:function(){n(e.order)},variant:"text",size:"small",children:"Export"}),Object(v.jsx)(O.a,{style:{padding:0},variant:"text",size:"small",onClick:function(){return function(e){d(Object(jt.a)(l.map((function(t){return t.order.id===e.order.id?Object(b.a)(Object(b.a)({},e),{},{hidden:!t.hidden,className:t.hidden?"basic-order-style":"basic-order-style confirmed-order-style"}):t}))))}(e)},children:e.hidden?"Show \u2795":"Hide \u2796"})]})]}),Object(v.jsx)("div",{className:e.className,children:Object(_e.a)(e.order.text)?(t=e.order.text,r=e.order.id,Object.entries(JSON.parse(t)).map((function(e,t){var n=Object(p.a)(e,2),a=n[0],c=n[1];return Object(v.jsxs)("div",{style:{minHeight:"1.2rem",backgroundColor:t%2!==0&&"var(--brand-color-very-light)"},children:[Object(v.jsx)("span",{style:{fontWeight:"bold"},children:a}),":"," ","dateTime"===a?"".concat(new Date(c).toLocaleDateString()," ").concat(new Date(c).toLocaleTimeString().slice(0,5)):c]},"".concat(a).concat(c).concat(r))}))):u(e.order.text,e.order.id)})]},e.order.id);var t,r})),Object(v.jsx)(O.a,{onClick:c,size:"small",children:"Load more"})]})}n(297);var gt="inbox",yt="trashcan";function kt(e){var t=e.handleExport,n=Object(r.useState)([]),a=Object(p.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(!0),o=Object(p.a)(s,2),l=o[0],d=o[1],u=Object(r.useState)(gt),h=Object(p.a)(u,2),f=h[0],x=h[1],g=Object(r.useState)({inbox:{pages:[1],searchText:"",showOnlyNotConfirmed:!1},trashcan:{pages:[1],searchText:"",showOnlyNotConfirmed:!1}}),w=Object(p.a)(g,2),C=w[0],S=w[1],N=Object(r.useState)(c),T=Object(p.a)(N,2),E=T[0],D=T[1],I=Object(r.useState)({hasToUpdate:!1,trigger:0}),z=Object(p.a)(I,2),L=z[0],F=z[1],P=Object(r.useState)({inbox:[1],trashcan:[1]}),A=Object(p.a)(P,2),U=A[0],W=A[1],M=c.length,R=c.filter((function(e){return!e.confirmed})).length;function B(e,t,n){var r;return function(e,t){return t?e.filter((function(e){return!1===(null===e||void 0===e?void 0:e.confirmed)})):e}((r=e,n.filter((function(e){return e.text.toLowerCase().includes(null===r||void 0===r?void 0:r.toLowerCase().trim())}))),t)}function q(){return(q=Object(m.a)(j.a.mark((function e(){var t,n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[U[f].length+1],W(Object(b.a)(Object(b.a)({},U),{},Object(y.a)({},f,[].concat(Object(jt.a)(U[f]),t)))),f!==gt){e.next=8;break}return e.next=5,Xe.get(t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Xe.get(t,{deleted:!0});case 10:e.t0=e.sent;case 11:n=e.t0,r=c.concat(n),i(r),a=B(C[f].searchText,C[f].showOnlyNotConfirmed,r),D(a);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){x(e.target.dataset.tabname)}function J(){return(J=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.remove(t);case 2:i(c.filter((function(e){return e.id!==t}))),D(E.filter((function(e){return e.id!==t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return(X=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe.retrieve(t);case 2:i(c.filter((function(e){return e.id!==t}))),D(E.filter((function(e){return e.id!==t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)(Object(m.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d(!0),e.prev=1,f!==gt){e.next=8;break}return e.next=5,Xe.get(U[f],{forceUpdate:L.hasToUpdate});case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Xe.get(U[f],{deleted:!0,forceUpdate:L.hasToUpdate});case 10:e.t0=e.sent;case 11:return t=e.t0,i(t),n=B(C[f].searchText,C[f].showOnlyNotConfirmed,t),D(n),e.abrupt("return",d(!1));case 18:return e.prev=18,e.t1=e.catch(1),e.abrupt("return",e.t1);case 21:case"end":return e.stop()}}),e,null,[[1,18]])}))),[f,L.trigger]);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"tab-panel",children:[Object(v.jsx)(O.a,{onClick:Y,className:"p-0",variant:"text",size:"small",children:Object(v.jsx)("h3",{"data-tabname":gt,className:f===gt?"tab-panel-item tab-panel-item-selected":"tab-panel-item",children:"Inbox"})}),Object(v.jsx)(O.a,{onClick:Y,className:"p-0",variant:"text",size:"small",children:Object(v.jsx)("h3",{"data-tabname":yt,className:f===yt?"tab-panel-item tab-panel-item-selected":"tab-panel-item",children:"Trashcan"})}),Object(v.jsx)(K.a,{style:{marginLeft:"auto",marginRight:"12px"},onClick:function(){F(Object(b.a)(Object(b.a)({},L),{},{trigger:L.trigger+1,hasToUpdate:!0})),setTimeout((function(){return F(Object(b.a)(Object(b.a)({},L),{},{hasToUpdate:!1}))}))},className:"p-0",variant:"text",size:"small",children:Object(v.jsx)(pt.a,{})})]}),Object(v.jsxs)("div",{className:"filters-tab",children:[Object(v.jsxs)("span",{className:"filters-tab-orders-count",children:[E.length,"/",c.length]}),Object(v.jsx)(k.a,{className:"flex-item",type:"text",name:"searchText",placeholder:"Search",value:C[f].searchText,onChange:function(e){var t=C[f];S(Object(b.a)(Object(b.a)({},C),{},Object(y.a)({},f,Object(b.a)(Object(b.a)({},t),{},{searchText:e.target.value}))));var n=B(e.target.value,t.showOnlyNotConfirmed,c);D(n)}}),R>0&&Object(v.jsxs)(O.a,{className:"p-0 filters-tab-orders-status-icon",size:"small",onClick:function(){return function(e){var t=C[f];S(Object(b.a)(Object(b.a)({},C),{},Object(y.a)({},f,Object(b.a)(Object(b.a)({},t),{},{showOnlyNotConfirmed:e}))));var n=B(t.searchText,e,c);D(n)}(!C[f].showOnlyNotConfirmed)},children:[Object(v.jsx)("span",{style:{fontSize:"1rem"},children:C[f].showOnlyNotConfirmed?M:R}),Object(v.jsx)("span",{className:"order-status-icon order-status-notification ".concat(C[f].showOnlyNotConfirmed&&"order-status-icon-selected"),children:C[f].showOnlyNotConfirmed?"\u2714&\u2755":"\u2755"})]})]}),Object(v.jsx)(Ot,{loading:l,children:Object(v.jsx)(vt,{orders:E,handleExport:t,labelForDeletion:f===yt?Object(v.jsx)(xt.a,{}):Object(v.jsx)(ht.a,{}),handleDeletion:f===yt?function(e){return X.apply(this,arguments)}:function(e){return J.apply(this,arguments)},handleLoadingMoreOrders:function(){return q.apply(this,arguments)}})})]})}function wt(e){var t=e.handleExport,n=Object(f.g)(),r=function(){n.goBack()};return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(ut,{handleClose:r,children:Object(v.jsx)(kt,{handleExport:function(e){t(e),r()}})})})}function Ct(){var e=Object(r.useState)({text:"",id:null}),t=Object(p.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)({text:"",id:null}),i=Object(p.a)(c,2),s=i[0],l=i[1],d=Object(r.useState)(nt.default()),u=Object(p.a)(d,2),j=u[0],m=u[1];Object(r.useEffect)((function(){var e=localStorage.getItem("confirmator_order"),t=localStorage.getItem("confirmator_rawOrder");e&&m(new nt(JSON.parse(e))),t&&a(JSON.parse(t))}),[]),Object(r.useEffect)((function(){localStorage.setItem("confirmator_order",JSON.stringify(j))}),[j]),Object(r.useEffect)((function(){localStorage.setItem("confirmator_rawOrder",JSON.stringify(n))}),[n]);var h=Object(o.b)().enqueueSnackbar;function x(e){return nt.transformToText(e,(function(e){return h(e,{autoHideDuration:750})}))}var O=Object(r.useRef)(null),g=Object(r.useRef)(null);function k(e){var t=new nt(Object(b.a)(Object(b.a)({},j),{},Object(y.a)({},e.target.name,"checkbox"===e.target.type?e.target.checked:e.target.value)));return m(t)}function w(e){a(Object(b.a)(Object(b.a)({},n),{},{id:e.id||null,text:e.text||e}))}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;nt.setupOrderFromText(e.text).then((function(t){return m(t),l({id:e.id,text:x(t)})})).catch((function(e){return h(e.message,{variant:"error"})}))}return Object(v.jsxs)("div",{className:"flex-container",children:[Object(v.jsx)(G,{elementRef:O,rawOrderText:n.text,handleClick:w}),Object(v.jsx)(L,{order:j,handleChange:k}),Object(v.jsx)(ce,{elementRef:g,transformDisabled:!n.text,copyDisabled:!s.text,handleOrderTransformFromText:C,handleOrderTransformFromEditor:function(){return l({id:n.id,text:x(j)})}}),Object(v.jsx)(Q,{elementRef:g,transformedOrderText:s.text,handleClick:function(e){l(Object(b.a)(Object(b.a)({},s),{},{text:e}))}}),Object(v.jsx)(R,{handleChange:k,order:j}),Object(v.jsx)(H,{order:j,shouldValidate:s.text}),Object(v.jsx)(ct,{order:j,orderId:n.id,transformedOrder:s,handleResetClick:function(){a({text:"",id:null}),l({text:"",id:null}),m(nt.default())},orderPoolUrl:"/confirmator/order-pool"}),Object(v.jsx)(f.b,{path:"/confirmator/order-pool",children:Object(v.jsx)(wt,{handleExport:function(e){w(e),C(e),setTimeout((function(){return O.current.scrollIntoView({smooth:!0})}),700)}})})]})}var St=n(368),Nt=n(363),Tt=n(367),Et=n(366),Dt=n(362),It=n(364),zt=n(365),Lt=n(352),Ft=n(355),Pt=n(25),At=n.n(Pt),Ut=n(161),Wt=n.n(Ut),Mt=n(162),Rt=n.n(Mt),Bt=n(163),qt=n.n(Bt);n(298);function Yt(e){var t=e.periodFrom,n=e.periodTo.isoWeek()-t.isoWeek()+1;return Array(n).fill(t.isoWeek()).map((function(e,t){return e+t})).map((function(e){return{periodFrom:At()().isoWeek(e).startOf("isoWeek").toISOString(),periodTo:At()().isoWeek(e+1).startOf("isoWeek").toISOString()}}))}function Jt(e,t){var n=[];return t.forEach((function(t){var r=e.filter((function(e){return At()(e.confirmedAt).isSameOrAfter(At()(t.periodFrom))&&At()(e.confirmedAt).isBefore(At()(t.periodTo))}));n.push(r)})),n}function Xt(e,t){return t.map((function(t,n){return{name:e[n],orderCount:t}}))}function Ht(e,t){return Xt(e.map((function(e,n){return"Week ".concat(At()(t[n].periodFrom).isoWeek())})),e.map((function(e){return e.length})))}function Kt(){var e=At()().startOf("month"),t=e.add(1,"month").startOf("month"),n=Object(r.useState)({periodFrom:e,periodTo:t}),a=Object(p.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)([]),o=Object(p.a)(s,2),l=o[0],d=o[1],u=Object(r.useState)({}),h=Object(p.a)(u,2),f=h[0],x=h[1],O=Object(r.useState)(null),g=Object(p.a)(O,2),w=g[0],C=g[1],S=Yt(c),N=Jt(l,S),T=Object(r.useState)([]),E=Object(p.a)(T,2),D=E[0],I=E[1];function z(e){i(Object(b.a)(Object(b.a)({},c),{},Object(y.a)({},e.target.name,At()(e.target.value))))}function L(e){C(e.currentTarget);var t=N[e.currentTarget.dataset.rownumber],n={};t.forEach((function(e){var t=new Date(e.confirmedAt).toLocaleDateString("en-US",{weekday:"long"});null==n[t]&&(n[t]=[]),n[t].push(e)})),x(n)}Object(r.useEffect)(Object(m.a)(j.a.mark((function e(){var t,n,r,a,i,s,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S=Yt(c),t=S[0],n=S[S.length-1],e.next=5,Xe.getConfirmedOrders({periodFrom:t.periodFrom,periodTo:n.periodTo});case 5:r=e.sent,a=r.confirmedOrders,d(a),N=Jt(a,S),i=Jt(a,[c]),s=Ht(N,S),o=Xt(["Total during specified period"],i.map((function(e){return e.length}))),I([].concat(Object(jt.a)(s),Object(jt.a)(o)));case 13:case"end":return e.stop()}}),e)}))),[c]);var F=Boolean(w),P=function(e){return e.orderCount>0&&!e.name.includes("Total")};return Object(v.jsxs)("div",{className:"statistics",children:[Object(v.jsxs)("div",{className:"row-flex-start gap-1 dates",children:[Object(v.jsx)(k.a,{onChange:z,name:"periodFrom",label:"Start of period",type:"date",value:c.periodFrom.format("YYYY-MM-DD")}),Object(v.jsx)(k.a,{onChange:z,name:"periodTo",label:"End of period",type:"date",value:c.periodTo.format("YYYY-MM-DD")})]}),Object(v.jsx)(Dt.a,{component:Ft.a,children:Object(v.jsxs)(Nt.a,{"aria-label":"statistics table",children:[Object(v.jsx)(It.a,{children:Object(v.jsxs)(zt.a,{children:[Object(v.jsx)(Et.a,{children:"Statistics"}),Object(v.jsx)(Et.a,{align:"right",children:"Confirmed orders"})]})}),Object(v.jsx)(Tt.a,{children:D.map((function(e,t){return Object(v.jsxs)(zt.a,{children:[Object(v.jsx)(Et.a,{component:"th",scope:"row",children:e.name}),Object(v.jsxs)(Et.a,{align:"right",children:[Object(v.jsx)(St.a,{style:{padding:10},placement:"left",open:F,anchorEl:w,children:Object(v.jsx)(Lt.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:function(){return C(null)},children:Object(v.jsx)(Ft.a,{children:Object(v.jsx)("div",{style:{padding:10},children:Object.entries(f).map((function(e){var t=Object(p.a)(e,2),n=t[0],r=t[1];return Object(v.jsxs)("div",{children:[n,": ",r.length]},n)}))})})})}),Object(v.jsx)(K.a,{"data-rownumber":t,size:"small",onClick:P(e)?L:null,children:e.orderCount})]})]},e.name)}))})]})})]})}At.a.extend(qt.a),At.a.extend(Wt.a),At.a.extend(Rt.a);n(299);var Vt=n.p+"static/media/paku24-logo.7602fc02.png";function _t(e){var t=e.isLogged;return Object(v.jsx)("div",{className:"logo",children:Object(v.jsxs)("div",{children:[Object(v.jsx)(s.b,{to:t?"/":"/login",children:Object(v.jsx)("img",{src:Vt,alt:"Logo",width:"125px"})}),Object(v.jsx)("span",{className:"text",children:"CONFIRMATOR"})]})})}var $t="/api/login",Gt=be.a.create();function Qt(){return(Qt=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gt.post($t,t).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zt(){return(Zt=Object(m.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gt.post("".concat($t,"/token"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Gt.interceptors.response.use((function(e){return e}),function(){var e=Object(m.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,"access token expired"!==t.response.data.error){e.next=13;break}return e.prev=2,e.next=5,be.a.post("/api/token");case 5:return e.next=7,be.a.post("/api/token/is-new");case 7:return e.abrupt("return",Gt(n));case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",e.t0);case 13:return e.abrupt("return",Promise.reject(t));case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}());var en={loginWithCredentials:function(e){return Qt.apply(this,arguments)},loginWithAccessToken:function(){return Zt.apply(this,arguments)}},tn=n(165),nn=n.n(tn),rn=function(e){var t=e.notification,n="black";return t.toLowerCase().includes("error")&&(n="red"),Object(v.jsx)(v.Fragment,{children:t?Object(v.jsxs)("div",{style:{backgroundColor:"white",color:n,padding:"10px",width:"80%",borderBottom:"3px solid darkgrey",fontSize:"small",display:"flex",alignItems:"center",marginBottom:"10px"},children:[Object(v.jsx)(nn.a,{}),Object(v.jsx)("span",{style:{marginLeft:"10px"},children:t})]}):null})};function an(e){var t,n=e.updateUser,a={marginBottom:"7px",backgroundColor:"white"},c=Object(f.g)(),i=null===c||void 0===c||null===(t=c.location.state)||void 0===t?void 0:t.referrer,o=Object(r.useState)(""),l=Object(p.a)(o,2),d=l[0],u=l[1],b=Object(r.useState)(""),h=Object(p.a)(b,2),x=h[0],g=h[1],y=Object(r.useState)(!1),w=Object(p.a)(y,2),C=w[0],S=w[1],N=Object(r.useState)(!1),T=Object(p.a)(N,2),E=T[0],D=T[1],I=Object(r.useState)(""),z=Object(p.a)(I,2),L=z[0],F=z[1];function P(){return(P=Object(m.a)(j.a.mark((function e(t){var r,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),F("Working..."),e.prev=2,e.next=5,en.loginWithCredentials({username:d,password:x});case 5:r=e.sent,a=r.user,F("Done"),c.push((null===i||void 0===i?void 0:i.length)>1?i:"/confirmator"),n(a),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(2),D(!0),S(!0),setTimeout((function(){return S(!1)}),2e3),F("Error: ".concat((null===(s=e.t0.response)||void 0===s?void 0:s.data.error)||"Mystery \ud83d\udc7b"));case 18:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return Object(v.jsx)("div",{style:{margin:"30px 5px"},children:Object(v.jsxs)("div",{style:{width:"95%",margin:"0 auto",padding:20,backgroundColor:"lightgrey",borderBottom:"4px solid darkgrey"},children:[Object(v.jsxs)("div",{style:{color:"black",fontSize:"1.3rem",letterSpacing:"0.7px",marginTop:"10px",marginBottom:"15px"},children:["LOGIN",Object(v.jsxs)("span",{style:{color:"black",fontSize:"1.0rem",letterSpacing:"0.2px"},children:[" ","or ",Object(v.jsx)(s.b,{to:"/register",children:"request access"})]})]}),Object(v.jsx)(rn,{notification:L}),Object(v.jsxs)("form",{onSubmit:function(e){return P.apply(this,arguments)},style:{paddingBottom:"10px",height:"80%",display:"flex",flexFlow:"column wrap",justifyContent:"space-evenly"},children:[Object(v.jsx)(k.a,{className:"flex-item",style:a,error:E,required:!0,name:"username",value:d,onChange:function(e){var t=e.target;return u(t.value)},label:"Username",variant:"filled",size:"small"}),Object(v.jsx)(k.a,{className:"flex-item",style:a,error:E,type:"password",required:!0,value:x,name:"password",onChange:function(e){var t=e.target;return g(t.value)},label:"Password",variant:"filled",size:"small"}),Object(v.jsx)(O.a,{className:"flex-item",style:a,type:"submit",disabled:C,variant:"contained",size:"small",children:"Login"})]})]})})}function cn(){var e={marginBottom:"7px",backgroundColor:"white"},t=Object(r.useState)(""),n=Object(p.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(""),o=Object(p.a)(i,2),l=o[0],d=o[1],u=Object(r.useState)(""),b=Object(p.a)(u,2),h=b[0],f=b[1],x=Object(r.useState)(""),g=Object(p.a)(x,2),y=g[0],w=g[1],C=Object(r.useState)(!1),S=Object(p.a)(C,2),N=S[0],T=S[1];function E(e){return D.apply(this,arguments)}function D(){return(D=Object(m.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be.a.post("/api/registration/request-access",t).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(m.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),T(!0),w("Working..."),e.prev=3,e.next=6,E({name:a,email:l,purpose:h});case 6:n=e.sent,w(null===n||void 0===n?void 0:n.message),c(""),d(""),f(""),T(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),T(!1),w("Error: ".concat((null===e.t0||void 0===e.t0||null===(r=e.t0.response.data)||void 0===r?void 0:r.error)||"Mystery \ud83d\udc7b"));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})))).apply(this,arguments)}return Object(v.jsx)("div",{style:{margin:"30px 5px"},children:Object(v.jsxs)("div",{style:{width:"95%",padding:20,margin:"0 auto",backgroundColor:"lightgrey",borderBottom:"4px solid darkgrey"},children:[Object(v.jsxs)("div",{style:{color:"black",fontSize:"1.3rem",letterSpacing:"0.7px",marginTop:"10px",marginBottom:"15px"},children:["REQUEST ACCESS",Object(v.jsxs)("span",{style:{color:"black",fontSize:"1.0rem",letterSpacing:"0.2px"},children:[" ","or ",Object(v.jsx)(s.b,{to:"/login",children:"login"})]})]}),Object(v.jsx)(rn,{notification:y}),Object(v.jsxs)("form",{onSubmit:function(e){return I.apply(this,arguments)},style:{paddingBottom:"10px",height:"80%",display:"flex",flexFlow:"column wrap",justifyContent:"space-evenly"},children:[Object(v.jsx)(k.a,{style:e,required:!0,name:"name",value:a,onChange:function(e){var t=e.target;return c(t.value)},label:"Name",variant:"filled",size:"small"}),Object(v.jsx)(k.a,{style:e,type:"email",required:!0,value:l,name:"email",onChange:function(e){var t=e.target;return d(t.value)},label:"Email",variant:"filled",size:"small"}),Object(v.jsx)(k.a,{style:e,type:"text",required:!0,multiline:!0,rows:"3",value:h,name:"purpose",onChange:function(e){var t=e.target;return f(t.value)},label:"Why do you want to use this application?",variant:"filled",size:"small"}),Object(v.jsx)(O.a,{style:e,type:"submit",disabled:N,variant:"contained",size:"small",children:"Send request"})]})]})})}n(300);var sn="/api/logout";function on(){return(on=Object(m.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be.a.post(sn).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ln={logout:function(){return on.apply(this,arguments)}},dn=n(166),un=n.n(dn);function jn(e){var t=e.handleClick;return Object(v.jsxs)(O.a,{style:{backgroundColor:"lightgrey"},variant:"outlined",size:"small",onClick:t,children:["Logout ",Object(v.jsx)(un.a,{})]})}function mn(e){var t=e.user,n=e.logoutUser;return Object(v.jsxs)("div",{style:{backgroundColor:"darkgrey",padding:"15px",display:"flex",justifyContent:"space-between",borderTop:"3.5px solid lightgrey",marginTop:"auto"},children:[Object(v.jsx)("div",{style:{paddingTop:"2px",marginRight:"20px"},children:Object(v.jsxs)("span",{style:{fontFamily:"monospace"},children:[" ",t.username,Object(v.jsx)("br",{}),t.name]})}),Object(v.jsx)(jn,{handleClick:function(){return ln.logout().then(n)}})]})}function pn(e){var t=e.error;return Object(v.jsxs)("div",{role:"alert",children:[Object(v.jsx)("p",{children:"Something went wrong:"}),Object(v.jsx)("pre",{style:{color:"red"},children:t.message})]})}function bn(e){var t,n=e.dependsOn,r=e.path,a=e.children,c=Object(h.a)(e,["dependsOn","path","children"]),i=Object(f.g)();null!==n&&"Loading"!==n||(t=i.location.pathname);var s="Loading"===n,o=null===n&&Object(v.jsx)(f.a,{to:{pathname:"/login",state:{referrer:t}}});return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Ot,{loading:s,redirectComponent:o,children:Object(v.jsx)(f.b,Object(b.a)(Object(b.a)({},c),{},{path:r,children:a}))})})}var hn=function(){var e,t=Object(r.useState)("Loading"),n=Object(p.a)(t,2),a=n[0],c=n[1],i=Object(o.b)().enqueueSnackbar,s=Object(f.g)();return null!==a&&"Loading"!==a||(e=s.location.pathname),Object(r.useEffect)(Object(m.a)(j.a.mark((function t(){var n,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ve.setupInterceptor({logout:function(){return c(null)},notificate:function(){return i("You were logged out for security reasons. Your work has been saved. Login to continue.",{variant:"warning",autoHideDuration:1e4})}}),t.prev=1,t.next=4,en.loginWithAccessToken();case 4:return n=t.sent,r=n.user,s.push(e),t.abrupt("return",c(r));case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",c(null));case 13:case"end":return t.stop()}}),t,null,[[1,10]])}))),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(_t,{isLogged:null!==a&&"Loading"!==a}),Object(v.jsxs)(x.ErrorBoundary,{FallbackComponent:pn,children:[Object(v.jsxs)(f.d,{children:[Object(v.jsx)(f.b,{path:"/register",children:Object(v.jsx)(cn,{})}),Object(v.jsx)(f.b,{path:"/login",children:null===a?Object(v.jsx)(an,{updateUser:c}):Object(v.jsx)(f.a,{to:"/"})}),Object(v.jsx)(bn,{dependsOn:a,path:"/confirmator",children:Object(v.jsx)(Ct,{})}),Object(v.jsx)(bn,{dependsOn:a,path:"/statistics",children:Object(v.jsx)(Kt,{})}),Object(v.jsx)(bn,{dependsOn:a,exact:!0,path:"/",children:Object(v.jsx)(g,{})})]}),Object(v.jsx)(bn,{dependsOn:a,path:"/",children:Object(v.jsx)(mn,{user:a,logoutUser:function(){return c(null)}})})]})]})},fn=(n(301),a.a.createRef());i.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(s.a,{basename:"/app",children:Object(v.jsx)(o.a,{action:function(e){return Object(v.jsx)(d.a,{onClick:function(){fn.current.closeSnackbar(e)}})},ref:fn,maxSnack:3,dense:!0,autoHideDuration:5e3,anchorOrigin:{horizontal:"left",vertical:"top"},children:Object(v.jsx)(hn,{})})})}),document.getElementById("root"))},59:function(e){e.exports=JSON.parse('[{"id":1,"name":"Pakettiauto ja kuljettaja","price":55,"priceXL":55},{"id":2,"name":"Pakettiauto ja muuttomies","price":70,"priceXL":70},{"id":3,"name":"Pakettiauto ja kaksi muuttomiest\xe4","price":100,"priceXL":100},{"id":4,"name":"Nouto/tyhjennyspalvelu yhdell\xe4 kantajalla","price":70,"priceXL":70},{"id":5,"name":"Nouto/tyhjennyspalvelu kahdella kantajalla","price":100,"priceXL":100},{"id":6,"name":"Van and driver (doesn\'t assist in carrying)","price":55,"priceXL":55},{"id":7,"name":"Van and mover","price":70,"priceXL":70},{"id":8,"name":"Van and two movers","price":100,"priceXL":100},{"id":9,"name":"Recycle service with one carrier","price":70,"priceXL":70},{"id":10,"name":"Recycle service with two carriers","price":100,"priceXL":100}]')},66:function(e){e.exports=JSON.parse('[{"id":1,"name":"Maksukortti"},{"id":2,"name":"K\xe4teinen"},{"id":3,"name":"Lasku/Osamaksu"},{"id":4,"name":"Bank card"},{"id":5,"name":"Cash"},{"id":6,"name":"Invoice/Instalment payment"}]')},71:function(e){e.exports=JSON.parse('{"morning":{"name":"Aamulis\xe4","amount":20},"night":{"name":"Y\xf6lis\xe4","amount":20},"holiday":{"name":"Pyh\xe4lis\xe4","amount":15},"weekend":{"name":"Viikonloppulis\xe4","amount":15},"firstOrLastDayOfTheMonth":{"name":"Kuunvaihdelis\xe4","amount":15},"bill":{"name":"Laskulis\xe4","amount":14}}')}},[[302,1,2]]]);
//# sourceMappingURL=main.7d5333d1.chunk.js.map